!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.RPlayer=t()}(this,function(){"use strict";var e={autoPlay:!1,defaultVolume:50,loop:!1,poster:"",preload:"metadata",source:"",msg:""},t={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},i={function:"[object Function]",object:"[object Object]",string:"[object String]",undef:"[object Undefined]"},n={up:5,arrowup:5,down:-5,arrowdown:-5,left:-10,arrowleft:-10,right:10,arrowright:10,esc:"esc",escape:"escape"," ":"space",spacebar:"space",enter:"enter"},r=document,s=function(e){return function(t){return Object.prototype.toString.call(t)===i[e]}},o=s("function"),l=s("object"),a=s("string"),u=s("undef");function h(e,t){if(arguments.length)for(var i in t){var n=t[i],r=e[i];l(n)&&l(r)?h(e[i],t[i]):e[i]=n}return e}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Array.isArray(e)?e.slice(t):e.length?Array.prototype.slice.call(e,t):[]}function d(e,t){if(t)try{delete e[t]}catch(e){}else for(t in e)delete e[t]}var f={handlers:{}},p=1;f.hasClass=function(e,t){return!!e&&(e.classList?e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1)},f.addClass=function(e,t){return e&&!this.hasClass(e,t)&&(e.classList?e.classList.add(t):e.className+=" "+t),this},f.removeClass=function(e,t){var i=new RegExp("\\s+"+t+"\\s+"),n=void 0;return e&&this.hasClass(e,t)&&(n=" "+e.className+" ",e.classList?e.classList.remove(t):e.className=n.replace(i," ").trim()),this},f.toggleClass=function(e,t){var i=new RegExp("\\s+"+t+"\\s+"),n=void 0;return e&&(e.classList?e.classList.toggle(t):(t=" "+t+" ",(n=" "+e.className+" ").indexOf(t)>-1?e.className=n.replace(i," ").trim():e.className+=" "+t)),this},f.css=function(e,t,i){var n="";if(u(i)){if(l(t)){for(i in t)n+=i+":"+t[i]+";";e.style.cssText+=n}else if(a(t))return getComputedStyle(e).getPropertyValue(t)}else e.style[t]=i;return this},f.fullScreen=function(e,t){var i=this.fsApi;return i?t?r[i.exitFullscreen]():e[i.requestFullscreen]():this.fullPage(e,t),this},f.fullPage=function(e,t){t?f.removeClass(e,"rplayer-fixed"):f.addClass(e,"rplayer-fixed")},f.selectElement=function(e,t){var i=void 0;t=t||r,e&&(e.nodeName||(n=e,n&&n.window===n)?i=e:"string"==typeof e&&(i=/^#[^>~+\[\]\s:]+$/.test(e)?r.getElementById(e.substring(1)):t.querySelector(e)));var n;return i},f.createElement=function(e,t){var i=r.createElement(e),n=void 0;if(l(t))for(n in t)i.setAttribute(n,t[n]);return i},f._on=function(e,t,i){var n=e.guid,r=void 0;n||(n=p++,Object.defineProperty(e,"guid",{value:n})),(r=this.handlers[n])?r[t]||(r[t]=[]):(r=this.handlers[n]={})[t]=[],r[t].push(i),e.addEventListener(t,i)},f.on=function(e,t,i,n){var r=this.selectElement(e),s=void 0;if(r)if(t){if(s=(t=t.split(" ")).length,o(i))for(;s--;){var l=t[s];n?this._off(r,l,i):this._on(r,l,i)}else if(n)for(;s--;)this._off(r,t[s])}else n&&this._off(r);return this},f._off=function(e,t,i){var n=this.handlers[e.guid];if(n)if(t&&(n=n[t]))if(i){for(var r=0,s=n.length;r<s;r++)if(n[r]===i){n.splice(r,1),e.removeEventListener(t,i);break}}else n.forEach(function(i){e.removeEventListener(t,i)}),f.handlers[t]=[];else if(!t)for(var o in n)this._off(e,o)},f.off=function(e,t,i){return this.on(e,t,i,!0)},f.once=function(e,t,i){var n=void 0,r=this;return o(i)&&(n=function(){var s=Array.prototype.slice.call(arguments);i.apply(this,s),r.off(e,t,n)},this.on(e,t,n)),this},f.fsApi=function(){for(var e=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],t=null,i=e[0],n=void 0,r=void 0,s=0,o=e.length;s<o;s++)if((n=e[s])[1]in document){r=!0;break}return r&&(t={},n.forEach(function(e,n){t[i[n]]=e})),t}();function m(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function v(){this.handlers={}}v.prototype={constructor:v,_on:function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},on:function(e,t){if(o(t)){if(!a(e))throw new TypeError("事件类型只能为String");for(var i=(e=e.split(" ")).length;i--;)this._on(e[i],t)}return this},_off:function(e,t){var i=this.handlers[e];if(i)if(o(t)){for(var n=i.length;n--;)if(t===i[n]){i.splice(n,1);break}}else u(t)&&(this.handlers[e]=[])},off:function(e,t){var i=arguments.length;if(i&&a(e))for(var n=c(arguments,1),r=(e=e.split(" ")).length;r--;){var s;(s=this._off).call.apply(s,[this,e[r]].concat(m(n)))}else i||(this.handlers={});return this},once:function(e,t){if(o(t)){var i=this;this.on(e,function n(){t.apply(this,arguments),i.off(e,n)})}},trigger:function(e){var t=c(arguments,1),i=this.handlers[e],n=void 0;if(i){(n=new function(e){this.type=e,this.data=null,this.timeStamp=0}(e)).data=t,n.timeStamp=Date.now(),t=[n].concat(t);for(var r=i.length;r--;)i[r].apply(this,t)}return this}};function g(e){v.call(this),this.vertical=!u(e)&&!!e,this.moveDis=this.pos=null,this.moving=!1}var y=g.prototype=Object.create(v.prototype);y.constructor=g,y.getPosition=function(){var e=this.el.parentNode.getBoundingClientRect(),t=getComputedStyle(this.el);return{width:parseFloat(t.width),height:parseFloat(t.height),origLeft:parseFloat(t.left),origTop:parseFloat(t.top),maxX:e.width,maxY:e.height}},y.updateHPosition=function(e,t){return t&&(e=100*e+"%"),f.css(this.bar,"width",e).css(this.el,"left",e),this},y.updateVPosition=function(e,t){return t&&(e=100*e+"%"),f.css(this.bar,"height",e).css(this.el,"bottom",e),this},y.mouseDown=function(e){if(!e.button){var t=e.clientX,i=e.clientY,n=this.getPosition(),s=this.getMoveCallback().bind(this);this.pos={width:n.width,height:n.height,offsetX:t-n.origLeft,offsetY:i-n.origTop,maxX:n.maxX,maxY:n.maxY},f.addClass(this.el,"rplayer-moving").on(r,"mousemove",s).on(r,"mouseup",this.mouseUp.bind(this))}},y.moveVertical=function(e,t){var i=void 0;return i=(i=this.pos.maxY-(t-this.pos.offsetY)-this.pos.height)<0?0:i>this.pos.maxY?this.pos.maxY:i,i/=this.pos.maxY,this.updateVPosition(i,!0),i},y.moveHorizontal=function(e){var t=void 0;return t=(t=e-this.pos.offsetX)<0?0:t>this.pos.maxX?this.pos.maxX:t,t/=this.pos.maxX,this.updateHPosition(t,!0),t},y.mouseMove=function(e,t){var i=e.clientX,n=e.clientY,r=t.call(this,i,n);this.moving=!0,this.trigger("slider.moving",this.moveDis=r)},y.getMoveCallback=function(){var e=this;return this.vertical?function(t){return e.mouseMove(t,e.moveVertical)}:function(t){return e.mouseMove(t,e.moveHorizontal)}},y.mouseUp=function(){f.off(r,"mousemove moseup").removeClass(this.el,"rplayer-moving"),this.moving&&this.trigger("slider.move.done",this.moveDis)},y.changePosition=function(e,t,i){"h"===t?this.updateHPosition(i,!0):this.updateVPosition(i)},y.clickTrack=function(e){if(this.moving)this.moving=!1;else{var t=this.track.getBoundingClientRect(),i=e.clientX,n=e.clientY,r="slider.moving";this.vertical?(t=(t.height-n+t.top)/t.height,this.updateVPosition(t,!0)):(t=(i-t.left)/t.width,r="slider.move.done",this.updateHPosition(t,!0)),this.trigger(r,t)}},y.initEvent=function(){return f.on(this.el,"mousedown",this.mouseDown.bind(this)).on(this.track,"click",this.clickTrack.bind(this)),this},y.destroy=function(){f.off(this.track).off(this.el),d(this)},y.init=function(e){var t={track:"rplayer-video-track",bar:"rplayer-video-progress",slider:"rplayer-video-slider"};return this.vertical&&(t={track:"rplayer-volume-progress",bar:"rplayer-volume-value",slider:"rplayer-volume-slider"}),this.track=f.createElement("div",{class:"rplayer-progress "+t.track}),this.bar=f.createElement("div",{class:"rplayer-bar "+t.bar}),this.el=f.createElement("div",{class:"rplayer-slider "+t.slider}),this.track.appendChild(this.bar),this.track.append(this.el),e.appendChild(this.track),this.on("position.change",this.changePosition),this.initEvent()};function b(){this.el=f.createElement("div",{class:"rplayer-loading rplayer-hide"})}b.prototype={constructor:b,show:function(){return f.removeClass(this.el,"rplayer-hide"),this},hide:function(){return f.addClass(this.el,"rplayer-hide"),this},toggle:function(){return f.toggleClass(this.el,"rplayer-hide"),this},init:function(e){return e.appendChild(this.el),this}};function E(){this.el=f.createElement("div",{class:"rplayer-error rplayer-hide"}),this.msgEl=f.createElement("div",{class:"rplayer-msg"})}E.prototype={constructor:E,show:function(e){return this.setMessage(e),f.removeClass(this.el,"rplayer-hide"),this},hide:function(){return f.addClass(this.el,"rplayer-hide"),this},setMessage:function(e){return this.msgEl.innerHTML=e,this},init:function(e){return this.el.appendChild(this.msgEl),e.appendChild(this.el),this}};function C(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function P(e){v.call(this),this.config=e,this.playedTime=null}var S="video.loaded.meta",w="video.time.update",T="video.load.start",k="video.progress";h(P.prototype=Object.create(v.prototype),{constructor:P,setVolume:function(e){return e>1&&(e/=100),e>1&&(e=1),this.el.volume=e,this.el.muted=!e,this},getVolume:function(){return Math.floor(100*this.el.volume)},mute:function(e){return this.el.muted=!!u(e)||!!e,this},isMuted:function(){return this.el.muted},autoPlay:function(e){return this.el.autoplay=!!e,this},isAutoPlay:function(){return this.el.autoplay},play:function(e){return u(e)||e?this.el.play():this.el.pause(),this},isPaused:function(){return this.el.paused},isError:function(){var e=this.el.error;return e?e.code:e},loop:function(e){return this.el.loop=!!e,this},isLoop:function(){return this.el.loop},setPoster:function(e){return this.el.poster=e,this},setPreload:function(e){return this.el.preload=e,this},setCurrentTime:function(e,t){var i=this.getDuration();return t&&(e*=i),this.el.currentTime=e,this},getCurrentTime:function(){return this.el.currentTime},getDuration:function(){return this.el.duration},getPlayedPercentage:function(){return this.getCurrentTime()/this.getDuration()},getBuffered:function(e){var t=this.el.buffered,i=t.length;return e?i?t=t.end(i-1)/this.getDuration()*100:null:t},getReadyState:function(){return this.el.readyState},showControls:function(){return this.el.controls=!0,this},convertTime:function(e){var t=function(e){return e<10?"0"+e:e.toString()},i=void 0,n=void 0,r=void 0,s=void 0;return(e=Math.ceil(e))<=0?i="00:00":e<60?i="00:"+t(e):e<3600?(s=e%60,i=t(r=Math.floor(e/60))+":"+t(s)):(n=Math.floor(e/3600),i=e%3600,r=Math.floor(i/60),s=i%60,i=t(n)+":"+t(r)+":"+t(s)),i},reload:function(){return this.el.load(),this},changeSource:function(e){var t=this.isPaused();return this.source!==e&&(this.source=e,this.initSource(e)),t||this.play(!0),this},getSource:function(){return this.el.currentSrc},initSource:function(e){var t=r.createDocumentFragment();return"string"==typeof e?this.el.src=e:Array.isArray(e)&&(this.el.innerHTML="",e.forEach(function(e){var i=f.createElement("source",{src:e});t.appendChild(i)}),this.el.appendChild(t)),this},handleError:function(){var e=this.isError(),i=void 0;switch(this.playedTime=this.getCurrentTime(),t[e]){case"MEDIA_ERR_ABORTED":i="出错了";break;case"MEDIA_ERR_NETWORK":i="网络错误或视频地址无效";break;case"MEDIA_ERR_DECODE":case"MEDIA_ERR_SRC_NOT_SUPPORTED":i="解码失败,不支持的视频格式或地址无效"}return{code:e,message:i+=",点击刷新"}},notify:function(e){var t,i=(t={},C(t,S,[{duration:this.getDuration()}]),C(t,w,[this.getCurrentTime()]),C(t,k,[this.getBuffered(!0),this.getReadyState()]),C(t,"video.error",[this.handleError()]),t)[e]||[];return e===T&&this.playedTime&&(this.setCurrentTime(this.playedTime),this.playedTime=0),this.trigger.apply(this,[e].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(i)))},initEvent:function(){var e=this.el;f.on(e,"loadedmetadata",this.notify.bind(this,S)).on(e,"timeupdate",this.notify.bind(this,w)).on(e,"dblclick",this.notify.bind(this,"video.dblclick")).on(e,"seeking",this.notify.bind(this,"video.seeking")).on(e,"loadstart",this.notify.bind(this,T)).on(e,"progress",this.notify.bind(this,k)).on(e,"canplay seeked",this.notify.bind(this,"video.can.play")).on(e,"ended",this.notify.bind(this,"video.ended")).on(e,"error",this.notify.bind(this,"video.error")).on(e,"contextmenu",function(e){return e.preventDefault()})},init:function(e){var t=f.createElement("video"),i=r.createTextNode(this.config.msg.toString());return this.source=this.config.source,t.appendChild(i),this.el=t,f.addClass(this.el,"rplayer-video"),e.appendChild(t),this.initSource(this.source).autoPlay(this.config.autoPlay).loop(this.config.loop).setPoster(this.config.poster).setPreload(this.config.preload).initEvent(),this},destroy:function(){f.off(this.el),this.off(),d(this)}});var D="volume.className.change";function F(e){v.call(this),this.el=f.createElement("div",{class:"rplayer-volume-popup rplayer-hide"}),this.valueEl=f.createElement("div",{class:"rplayer-current-volume"}),this.muteBtn=f.createElement("button",{class:"rplayer-mute volume-1"}),this.slider=new g(!0),this.volume=e,this.muted=!1}h(F.prototype=Object.create(v.prototype),{constructor:F,show:function(){return f.removeClass(this.el,"rplayer-hide"),this},hide:function(){return f.addClass(this.el,"rplayer-hide"),this},toggle:function(){return f.toggleClass(this.el,"rplayer-hide"),this},updateVolume:function(e,t,i){return t&&(e*=100),e=Math.floor(e),this.volume=e,e?(this.muted=!1,this.trigger("volume.update",e)):(this.muted=!0,this.trigger("volume.mute",this.muted)),this.updateStyle(e,i),this},updateVolumeByStep:function(e){var t=this.volume+e;t=t>100?100:t<0?0:t,this.updateVolume(t)},updateStyle:function(e,t){var i=this.muteBtn.className,n=/volume-\S+/;return i=i.replace(n,""),n=e?e<=33?"volume-1":e<=66?"volume-2":"volume-3":"volume-mute",this.muteBtn.className=i+n,this.valueEl.innerHTML=e,!t&&this.slider.updateVPosition(e+"%"),this.trigger(D,n),this},mute:function(){(this.muted=!this.muted)?this.updateStyle(0):this.updateStyle(this.volume),this.trigger("volume.mute",this.muted)},initEvent:function(){var e=this;return f.on(this.muteBtn,"click",this.mute.bind(this)).on(this.el,"mouseleave",this.hide.bind(this)).on(r,"click",function(t){var i=t.target;i===e.el||e.el.contains(i)||e.hide()}),this.slider.on("slider.moving",function(t,i){e.updateVolume(i,!0,!0)}),this},init:function(e){return this.el.appendChild(this.valueEl),this.slider.init(this.el),this.el.appendChild(this.muteBtn),e.appendChild(this.el),this.updateVolume(this.volume).initEvent(),this}});var x=null,M=null,R="rplayer-hide";function B(t,i){var n=f.selectElement(t),r=void 0;if(v.call(this),(r=l(i)?{autoPlay:!!i.autoPlay,defaultVolume:Math.abs(parseInt(i.defaultVolume))||e.defaultVolume,loop:!!i.loop,msg:i.msg||e.msg,poster:i.poster||e.poster,preload:i.preload||e.preload,source:i.source}:e).source,!n)throw new Error("未选中任何元素");this.target=n,this.controlsDisabled=!1,this.video=new P(r),this.loading=new b,this.error=new E,this.volumeControl=new F(r.defaultVolume),this.controls=!!u(i.controls)||!!i.controls,this.useNativeControls=!u(i.useNativeControls)&&i.useNativeControls}var V=B.prototype=Object.create(v.prototype);return V.constructor=B,V.toggleFullScreen=function(){(this.isFullScreen=!this.isFullScreen)?this.requestFullScreen():this.exitFullScreen()},V.requestFullScreen=function(){this.isFullScreen=!0,f.fullScreen(this.container).addClass(this.fullScreenBtn,"rplayer-fullscreen").addClass(this.container,"rplayer-fullscreen")},V.exitFullScreen=function(){this.isFullScreen=!1,f.fullScreen(this.container,!0).removeClass(this.fullScreenBtn,"rplayer-fullscreen").removeClass(this.container,"rplayer-fullscreen")},V.initFullScreenEvent=function(){var e=this,t=f.fsApi;return t&&f.on(r,t.fullscreenchange,function(){r[t.fullscreenElement]||e.exitFullScreen()}).on(r,t.fullscreenerror,function(){e.exitFullScreen()}),this},V.toggleVolumePopupInfo=function(e){var t=this;return clearTimeout(x),this.volumePopupInfo.innerHTML="当前音量: "+e,f.removeClass(this.volumePopupInfo,R),x=setTimeout(function(){return f.addClass(t.volumePopupInfo,R)},3e3),this},V.keyDown=function(e){if(!this.controlsDisabled){var t=e.key.toLowerCase(),i=n[t];i&&(/(?:left)|(?:right)/.test(t)?this.updateProgressByStep(i):/(?:up)|(?:down)/.test(t)?this.volumeControl.updateVolumeByStep(i):/esc/.test(t)?this.exitFullScreen():/\s|(?:spacebar)/.test(t)?this.togglePlay():this.toggleFullScreen()),e.preventDefault()}},V.toggleVolumeSettingsPanel=function(e){this.controlsDisabled||this.volumeControl.toggle(),e.stopPropagation()},V.hideVolumeSettingsPanel=function(){return f.addClass(this.volumePopup,R),this},V.initVolumeEvent=function(){var e=this;return this.volumeControl.on("volume.update",function(t,i){return e.video.setVolume(i)}).on(D,function(t,i){var n=e.showVolumePopBtn.className;e.showVolumePopBtn.className=n.replace(/volume-\S+/,"")+i}).on("volume.mute",function(t,i){return i?e.video.mute(!0):e.video.mute(!1)}),this},V.togglePlay=function(){this.controlsDisabled||(this.video.isPaused()?this.play():this.pause())},V.play=function(){return f.addClass(this.playBtn,"paused"),this.video.play(!0),this},V.pause=function(){return this.video.play(!1),f.removeClass(this.playBtn,"paused"),this},V.showPopupTimeInfo=function(e){var t=this.video.getDuration(),i=this.videoPopupTime,n=this.mark;if(t){f.removeClass(i,R).removeClass(n,R);var r=this.progressPanel.getBoundingClientRect(),s=e.clientX-r.left,o=i.offsetWidth,l=s-o/2;o=r.width-o,l=l<0?0:l>o?o:l,o=s/r.width,i.innerHTML=this.video.convertTime(o*t),f.css(i,"left",l+"px"),f.css(n,"left",100*o+"%")}return this},V.hidePopupTimeInfo=function(){return f.addClass(this.videoPopupTime,R).addClass(this.mark,R),this},V.updateProgressByStep=function(e){var t=this.video.getCurrentTime(),i=this.video.getDuration();return t=(t+=e)<0?0:t>i?i:t,this.video.setCurrentTime(t),t=this.video.getPlayedPercentage(),this.videoSlider.trigger("position.change","h",t)},V.hideControls=function(){return f.addClass(this.controlsPanel,R),this},V.showControls=function(){var e=this;return this.video.isError()||(clearTimeout(M),f.removeClass(this.controlsPanel,R),f.hasClass(this.volumePopup,R)&&(M=setTimeout(function(){return e.hideControls()},5e3))),this},V.enableControls=function(){return f.removeClass(this.controlsPanel,"rplayer-disabled"),this.controlsDisabled=!1,this},V.disableControls=function(){return f.addClass(this.controlsPanel,"rplayer-disabled"),this.controlsDisabled=!0,this},V.initControlEvent=function(){var e=this;return this.videoSlider.on("slider.move.done",function(t,i){e.video.setCurrentTime(i,!0),e.updateTime()}),this.video.on(k,function(t,i,n){return e.buffer(i,n)}).on(S,function(t,i){return e.updateMetaInfo(i)}).on(w,function(t,i){return e.updateTime(i)}).on("video.dblclick",this.toggleFullScreen.bind(this)),f.on(this.progressPanel,"mouseover mousemove",this.showPopupTimeInfo.bind(this)).on(this.progressPanel,"mouseout",this.hidePopupTimeInfo.bind(this)).on(this.container,"keydown",this.keyDown.bind(this)).on(this.container,"mousemove",this.showControls.bind(this)),this.initVolumeEvent().initFullScreenEvent()},V.handleClick=function(e){switch(e.target){case this.showVolumePopBtn:this.toggleVolumeSettingsPanel(e);break;case this.muteBtn:this.mute();break;case this.playBtn:case this.video.el:this.togglePlay();break;case this.fullScreenBtn:this.toggleFullScreen();break;case this.error.msgEl:this.refresh()}},V.buffer=function(e,t){this.bufferedBar&&f.css(this.bufferedBar,"width",e+"%"),t<3&&this.loading.show()},V.updateTime=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.video.getCurrentTime(),t=arguments[1],i=this.currentTime;return t&&(i=this.totalTime),i.innerHTML=this.video.convertTime(e),this},V.updateMetaInfo=function(e){this.video.isAutoPlay()&&this.play(),this.updateTime(e.duration,!0).enableControls()},V.playEnd=function(){return this.trigger("play.end"),this.video.isLoop()?this.play():this.pause()},V.hideError=function(){return this.controlsDisabled=!1,this},V.handleError=function(e){return this.controlsDisabled=!0,this.loading.hide(),this.error.show(e.message),this},V.refresh=function(){this.video.reload(),this.error.hide()},V.initEvent=function(){var e=this;return f.on(this.container,"click",this.handleClick.bind(this)),this.video.on(T,function(){e.loading.show(),e.disableControls()}).on("video.seeking",function(){return e.loading.show()}).on("video.can.play",function(){return e.loading.hide()}).on("video.ended",this.playEnd.bind(this)).on("video.error",function(t,i){return e.handleError(i)}),this},V.initElements=function(){var e=this.container,t=f.selectElement(".rplayer-audio-control",e);return this.playBtn=f.selectElement(".rplayer-play-btn",e),this.progressPanel=f.selectElement(".rplayer-progress-panel",e),this.videoPopupTime=f.selectElement(".rplayer-popup-video-info",e),this.currentTime=f.selectElement(".rplayer-current-time",e),this.totalTime=f.selectElement(".rplayer-total-time",e),this.bufferedBar=f.selectElement(".rplayer-bufferd-bar",e),this.showVolumePopBtn=f.selectElement(".rplayer-audio-btn",e),this.volumePopupInfo=f.selectElement(".rplayer-popup-volume-info",e),this.fullScreenBtn=f.selectElement(".rplayer-fullscreen-btn",e),this.mark=f.selectElement(".rplayer-mark",e),this.volumeControl.init(t),this.videoSlider=new g,this.videoSlider.init(this.progressPanel),this},V.initControls=function(){return this.controlsPanel=f.createElement("div"),f.addClass(this.controlsPanel,"rplayer-controls"),this.controlsPanel.innerHTML='<div class="rplayer-popup-info rplayer-popup-video-info rplayer-hide">10:00</div>        <div class="rplayer-progress-panel">            <div class="rplayer-bufferd-bar"></div>            <div class="rplayer-mark rplayer-hide"></div>        </div>        <div class="rplayer-play-control rplayer-lf">            <button type="button" class="rplayer-play-btn"></button>            <span class="rplayer-time-info">               <span class="rplayer-current-time">00:00</span>/               <span class="rplayer-total-time">00:00</span>             </span>        </div>        <div class="rplayer-settings rplayer-rt">            <button type="button" class="rplayer-fullscreen-btn rplayer-rt"></button>            <div class="rplayer-audio-control rplayer-rt">                <button type="button" class="rplayer-audio-btn volume-1"></button>            </div>        </div>',this.container.appendChild(this.controlsPanel),this.initElements().initControlEvent()},V.offEvent=function(){return f.off(r).off(this.volumePopup).off(this.container).off(this.video.el),this},V.destroy=function(){return this.container&&(this.videoSlider.destroy(),this.video.destroy(),d(this),this.offEvent()),this},V.getSource=function(){return this.video.getSource()},V.updateSource=function(e){this.video.changeSource(e)},V.initialize=function(){if(!this.container){var e=f.createElement("div",{tabIndex:100}),t=parseInt(getComputedStyle(this.target).height);this.isFullScreen=!1,e.innerHTML='<div class="rplayer-popup-info rplayer-popup-volume-info rplayer-hide">10:00</div>',f.css(e,"height",(t||500)+"px"),this.container=e,this.video.init(e),this.loading.init(e),this.error.init(e),f.addClass(e,"rplayer-container"),this.controls&&!this.useNativeControls?this.initControls():this.useNativeControls&&this.video.showControls(),this.target.appendChild(e),this.initEvent()}return this},B.init=function(e,t){return new B(e,t).initialize()},B});