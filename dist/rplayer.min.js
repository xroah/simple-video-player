!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.RPlayer=t()}(this,function(){var e={handlers:{}},t=document,l=1;function r(e){return"[object Function]"===Object.prototype.toString.call(e)}e.hasClass=function(e,t){return e.classList?e.classList.contains(t):new RegExp(t).test(e.className)},e.addClass=function(e,t){return this.hasClass(e,t)||(e.classList?e.classList.add(t):e.className+=" "+t),this},e.removeClass=function(e,t){var l=new RegExp("\\s*"+t+"\\s*");return this.hasClass(e,t)&&(e.classList?e.classList.remove(t):e.className=e.className.replace(l," ").trim()),this},e.replaceClass=function(e,t){return e.className=t,this},e.fullScreen=function(e,l){var r=this.fsApi;return r?l?e[r.requestFullscreen()]():t[r.exit]():this.fullPage(e,!1),this},e.fullPage=function(t,l){l?e.removeClass(t,"fixed"):e.addClass(t,"fixed")},e.selectElement=function(e,l){var r;return l=l||t,e&&(e.nodeName?r=e:"string"==typeof e&&(/^#[^>~+\[\]\s]+$/.test(e)?(r=t.getElementById(e.substring(1)),console.log(e,r)):r=t.querySelector(e))),r},e._on=function(e,t,r){var n,i=e.guid;i||(i=l++,Object.defineProperty(e,"guid",{value:i})),(n=this.handlers[i])?n[t]||(n[t]=[]):(n=this.handlers[i]={})[t]=[],n[t].push(r),e.addEventListener(t,r)},e.on=function(e,t,l,n){var i=this.selectElement(e);return i&&r(l)?n?this._off(i,t,l):this._on(i,t,l):i&&!r(l)&&this._off(i,t),this},e._off=function(t,l,r){var n,i=t.guid,s=e.handlers[i],o=0;if(s&&(s=s[l]))if(n=s.length,r){for(;o<n;o++)if(s[o]===r){s.splice(o,1),t.removeEventListener(l,r);break}}else s.forEach(function(e){t.removeEventListener(l,e)}),e.handlers[l]=[]},e.off=function(e,t,l){return this.on(e,t,l,!0)},e.once=function(e,t,l){var n,i=this;r(l)&&(n=function(){var r=Array.prototype.slice.call(arguments);l.apply(this,r),i.off(e,t,n)},this.on(e,t,n))};e.fsApi=function(){for(var e,t,l=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=null,n=l[0],i=0,s=l.length;i<s;i++)if((e=l[i])[1]in document){t=!0;break}return t&&(r={},e.forEach(function(e,t){r[n[t]]=e})),r}();var n={autoPlay:!1,defaultVolume:50,loop:!1,poster:"",preload:"metadata",source:"",msg:""};function i(e){var t,l,r,n,i=function(e){return e<10?"0"+e:e.toString()};return(e=Math.ceil(e))<=0?t="00:00":e<60?t="00:"+i(e):e<3600?(n=e%60,t=i(r=Math.floor(e/60))+":"+i(n)):(l=Math.floor(e/3600),t=e%3600,r=Math.floor(t/60),n=t%60,t=i(l)+":"+i(r)+":"+i(n)),t}function s(t,l){var r=e.selectElement(t);i=l,"[object Object]"===Object.prototype.toString.call(i)?this.config={autoPlay:!!l.autoPlay,defaultVolume:Math.abs(parseInt(l.defaultVolume))||n.defaultVolume,loop:!!l.loop,poster:l.poster||n.poster,source:l.source,msg:l.msg||n.msg}:this.config=n;var i;if(this.config.source,!r)throw new Error("未选中任何元素");this.target=r,this.playing=!1,this.volume=this.config.defaultVolume,this.muted=!1,this.isFullScreen=!1}var o=s.prototype;return o.initFullScreenEvent=function(){var t=this,l=e.fsApi;l&&e.on(e.doc,l.fullscreenchange,function(){}),e.on(".rplayer-fullscreen-btn","click",function(){t.isFullScreen||e.fullScreen(t.container).addClass(this,"fullscreen").addClass(t.container,"fullscreen")})},o.setVolume=function(e,t,l,r,n,i){return i=Math.ceil(i),this.videoEl.volume=i/100,this.volume=i,this.changeVolumeStyle.apply(this,arguments),this},o.changeVolumeStyle=function(e,t,l,r,n,i){var s=e.className;return s=s.replace(/volume-[^\s]*/,""),s+=i?i<=33?"volume-1":i<=66?"volume-2":"volume-3":"volume-mute",l.style.bottom=r.style.height=i+"%",e.className=t.className=s,n.innerHTML=i,this.videoEl.muted=this.muted=!i,this},o.initVolumeEvent=function(){var l,r=this,n=this.container,i=e.selectElement(".rplayer-audio-btn",n),s=e.selectElement(".rplayer-mute",n),o=e.selectElement(".rplayer-volume-popup",n),a=e.selectElement(".rplayer-volume-info",n),c=e.selectElement(".rplayer-volume-slider",n),u=e.selectElement(".rplayer-volume-progress",n),d=e.selectElement(".rplayer-volume-value",n),p=e.selectElement(".rplayer-current-volume",n);return e.on(i,"click",function(t){var l="rplayer-hide";e.hasClass(o)&&e.addClass(o,l),e.hasClass(o,l)?e.removeClass(o,l):e.addClass(o,l),t.stopPropagation()}).on(c,"mousedown",function(l){if(!l.button){var n=this.offsetTop+12,o=l.clientY,a=d.parentNode.offsetHeight;e.on(r.container,"mousemove",function(e){var t=e.clientY,l=a-(t-o+n);l=(l=l<0?0:l>a?a:l)/a*100,r.setVolume(i,s,c,d,p,l)}).on(t,"mouseup",function(){e.off(r.container,"mousemove").off(t,"mouseup")})}}).on(u,"click",function(e){var t=this.getBoundingClientRect(),l=e.clientY;e.target!==c&&(t=(t.height-l+t.top)/t.height*100,r.setVolume(i,s,c,d,p,t))}).on(s,"click",function(){var e=[i,s,c,d,p];console.log(r.volume),(r.muted=!r.muted)?(e.push(0),r.videoEl.mute=!0):(e.push(r.volume),r.videoEl.mute=!1),r.changeVolumeStyle.apply(r,e)}).on(this.container,"keydown",function(t){var n=t.key.toLowerCase(),u=r.volume,f={up:5,arrowup:5,down:-5,arrowdown:-5}[n];f&&(t.preventDefault(),u=(u+=f)>100?100:u<0?0:u,r.setVolume(i,s,c,d,p,u),e.hasClass(o,"rplayer-hide")&&(clearTimeout(l),a.innerHTML=p.innerHTML=r.volume,e.removeClass(a,"rplayer-hide"),l=setTimeout(function(){e.addClass(a,"rplayer-hide")},3e3)))}),this.setVolume(i,s,c,d,p,this.config.defaultVolume),this},o.initPlayEvent=function(){var l=this,r=this.container,n=e.selectElement(".rplayer-play-btn",r),s=e.selectElement(".rplayer-video-track",r),o=e.selectElement(".rplayer-video-slider",r),a=e.selectElement(".rplayer-video-progress",r),c=e.selectElement(".rplayer-current-time",r),u=e.selectElement(".rplayer-total-time",r),d=e.selectElement(".rplayer-loading",r),p=e.selectElement(".rplayer-bufferd-bar",r);return e.on(n,"click",function(){(l.playing=!l.playing)?(e.addClass(this,"paused"),l.videoEl.play()):(l.videoEl.pause(),e.removeClass(this,"paused"))}).on(s,"click",function(e){var t=this.getBoundingClientRect(),r=e.clientX;e.target!==o&&(t=(r-t.left)/t.width,l.videoEl.currentTime=l.videoEl.duration*t,console.log(l.videoEl.currentTime),a.style.width=o.style.left=100*t+"%")}).on(o,"mousedown",function(r){if(!r.button){var n,i=this.offsetLeft,s=r.clientX,c=a.parentNode.offsetWidth;e.on(l.container,"mousemove",function(e){var t=e.clientX;n=(n=(n=t-s+i)<0?0:n>c?c:n)/c*100,a.style.width=o.style.left=n+"%",l.videoEl.pause()}).on(t,"mouseup",function(){e.off(l.container,"mousemove").off(t,"mouseup"),l.videoEl.currentTime=l.videoEl.duration*n/100,l.videoEl.play()})}}).on(this.videoEl,"loadedmetadata",function(){u.innerHTML=i(this.duration),console.log("duration====",l.videoEl.duration)}).on(this.videoEl,"canplay",function(){e.removeClass(d,"loading").addClass(d,"rplayer-hide")}).on(this.videoEl,"progress",function(){var t=this.buffered,l=t.length;l&&(l=(l=t.end(l-1))/this.duration*100,p.style.width=l+"%"),this.readyState<3&&e.addClass(d,"loading").removeClass(d,"rplayer-hide")}).on(this.videoEl,"timeupdate",function(){var e=this.currentTime/this.duration*100;a.style.width=o.style.left=e+"%",c.innerHTML=i(this.currentTime)}).on(this.videoEl,"abort",function(){console.log("abort"),a.style.width=o.style.left=0}).on(this.videoEl,"error",function(){console.log("error")}).on(this.videoEl,"seeking",function(){console.log("seeking")}),this},o.initEvent=function(){var l=e.selectElement(".rplayer-volume-popup",this.container);return e.on(t,"click",function(t){var r=t.target;l===r||l.contains(r)||e.addClass(l,"rplayer-hide")}),this.initPlayEvent().initVolumeEvent()},o.destroy=function(){return this.container&&(this.target.removeChild(this.container),this.container=null),this},o.initSource=function(e){var l=this.config.source;"string"==typeof l?e.src=l:Array.isArray(l)&&l.forEach(function(l){var r=t.createElement("source");r.src=l,e.appendChild(r)})},o.initialize=function(){return this.destroy(),this.container=t.createElement("div"),this.container.tabIndex=100,this.container.innerHTML='<div class="rplayer-loading rplayer-hide"></div>    <div class="rplayer-controls">        <div class="rplayer-popup-info rplayer-video-time-info rplayer-hide">10:00</div>        <div class="rplayer-progress-panel">            <div class="rplayer-progress rplayer-video-track">                <div class="rplayer-bufferd-bar"></div>                <div class="rplayer-progress-track">                    <div class="rplayer-bar rplayer-video-progress"></div>                    <div class="rplayer-slider rplayer-video-slider"></div>                </div>            </div>        </div>        <div class="rplayer-play-control rplayer-lf">            <button type="button" class="rplayer-play-btn"></button>            <span class="rplayer-time-info">                        <span class="rplayer-current-time">00:00</span>/                        <span class="rplayer-total-time">00:00</span>                    </span>        </div>        <div class="rplayer-settings rplayer-rt">            <button type="button" class="rplayer-fullscreen-btn rplayer-rt"></button>            <div class="rplayer-audio-control rplayer-rt">                <div class="rplayer-popup-info rplayer-volume-info rplayer-hide">10:00</div>                <button type="button" class="rplayer-audio-btn volume-1"></button>                <div class="rplayer-volume-popup rplayer-hide">                    <span class="rplayer-current-volume">12</span>                    <div class="rplayer-progress rplayer-volume-progress">                        <div class="rplayer-audio-track">                            <div class="rplayer-bar rplayer-volume-value"></div>                            <div class="rplayer-slider rplayer-volume-slider"></div>                        </div>                    </div>                    <button class="rplayer-mute volume-1"></button>                </div>            </div>        </div>    </div>',this.initSource(this.videoEl=t.createElement("video")),this.videoEl.appendChild(t.createTextNode(this.config.msg)),e.addClass(this.container,"rplayer-container").addClass(this.videoEl,"rplayer-video"),this.container.appendChild(this.videoEl),this.target.appendChild(this.container),this.initEvent(),this},s.init=function(e,t){return new s(e,t).initialize()},s});