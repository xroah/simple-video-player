{"version":3,"file":"rplayer.js","sources":["../src/scripts/global.js","../src/scripts/dom/index.js","../src/scripts/subscriber.js","../src/scripts/message/loading.js","../src/scripts/message/error.js","../src/scripts/controls/video/video_control.js","../src/scripts/controls/slider.js","../src/scripts/message/popup.js","../src/scripts/controls/video/video_progress.js","../src/scripts/controls/volume_control.js","../src/scripts/dom/fullscreen_api.js","../src/scripts/controls/video/fullscreen.js","../src/scripts/message/time_info.js","../src/scripts/controls/index.js","../src/scripts/index.js"],"sourcesContent":["\"use strict\";\nconst DEFAULT_OPTIONS = {\n        autoPlay: false,\n        defaultVolume: 50,\n        loop: false,\n        poster: \"\",\n        preload: \"metadata\",\n        source: \"\",\n        msg: \"\",\n        useNativeControls: false\n    },\n    ERROR_TYPE = { //视频播放错误类型\n        \"1\": \"MEDIA_ERR_ABORTED\",\n        \"2\": \"MEDIA_ERR_NETWORK\",\n        \"3\": \"MEDIA_ERR_DECODE\",\n        \"4\": \"MEDIA_ERR_SRC_NOT_SUPPORTED\"\n    },\n    TYPE = {\n        function: \"[object Function]\",\n        object: \"[object Object]\",\n        string: \"[object String]\",\n        undef: \"[object Undefined]\"\n    },\n    VOLUME_STEP = 5,\n    VIDEO_STEP = 10,\n    KEY_MAP = {\n        \"up\": VOLUME_STEP, //IE\n        \"arrowup\": VOLUME_STEP,\n        \"down\": -VOLUME_STEP, //IE\n        \"arrowdown\": -VOLUME_STEP,\n        \"left\": -VIDEO_STEP, //IE\n        \"arrowleft\": -VIDEO_STEP,\n        \"right\": VIDEO_STEP, //IE\n        \"arrowright\": VIDEO_STEP,\n        \"esc\": \"esc\", //IE\n        \"escape\": \"escape\",\n        \" \": \"space\",\n        \"spacebar\": \"space\", //IE\n        \"enter\": \"enter\"\n    };\nlet doc = document,\n    isType = type => obj => Object.prototype.toString.call(obj) === TYPE[type],\n    isFunction = isType(\"function\"),\n    isObject = isType(\"object\"),\n    isString = isType(\"string\"),\n    isUndefined = isType(\"undef\"),\n    isWindow = obj => obj && obj.window === obj;\n\nexport function extend(target, source) {\n    if (arguments.length) {\n        for (let key in source) {\n            let copy = source[key],\n                t = target[key];\n            if (isObject(copy) && isObject(t)) {\n                extend(target[key], source[key]);\n            } else {\n                target[key] = copy;\n            }\n        }\n    }\n    return target;\n}\n\nexport function toArray(likeArr, start = 0) {\n    return Array.isArray(likeArr) ? likeArr.slice(start) :\n        likeArr.length ?  Array.prototype.slice.call(likeArr, start) : [];\n}\n\nexport function removeProp(obj, prop) {\n    if (prop) {\n        try{\n            delete obj[prop];\n        }catch (e){}\n    } else {\n        for (prop in obj) {\n            obj[prop] = null;\n            delete obj[prop];\n        }\n    }\n}\n\nexport function noop() {\n    return function () {};\n}\n\nexport function convertTime(time) {\n    let changeLen = num => num < 10 ? \"0\" + num : num.toString(),\n        str, h, m, s;\n    time = Math.ceil(time);\n    if (time <= 0) {\n        str = \"00:00\";\n    } else if (time < 60) {\n        str = \"00:\" + changeLen(time);\n    } else if (time < 3600) {\n        m = Math.floor(time / 60);\n        s = time % 60;\n        str = changeLen(m) + \":\" + changeLen(s);\n    } else {\n        h = Math.floor(time / 3600);\n        str = time % 3600;\n        m = Math.floor(str / 60);\n        s = str % 60;\n        str = changeLen(h) + \":\" + changeLen(m) + \":\" + changeLen(s);\n    }\n    return str;\n}\n\nexport {\n    doc,\n    DEFAULT_OPTIONS,\n    ERROR_TYPE,\n    KEY_MAP,\n    isFunction,\n    isObject,\n    isString,\n    isUndefined,\n    isWindow\n};","import {doc, isFunction, isObject, isUndefined, isString, isWindow} from \"../global.js\";\nlet dom = {\n        handlers: {}\n    },\n    guid = 1;\n\ndom.hasClass = function (el, cls) {\n    if (!el) return false;\n    if (el.classList) {\n        return el.classList.contains(cls);\n    }\n    //如果className为XXX-active, cls为active,\n    //如果不加空格判断则获取的结果不准确\n    return (\" \" + el.className + \" \").indexOf(\" \" + cls + \" \") > -1;\n};\n\ndom.addClass = function (el, cls) {\n    if (el && !this.hasClass(el, cls)) {\n        if (el.classList) {\n            el.classList.add(cls);\n        } else {\n            el.className += \" \" + cls;\n        }\n    }\n    return this;\n};\n\ndom.removeClass = function (el, cls) {\n    let reg = new RegExp(\"\\\\s+\" + cls + \"\\\\s+\"),\n        className;\n    if (el && this.hasClass(el, cls)) {\n        className = \" \" + el.className + \" \";\n        if (el.classList) {\n            el.classList.remove(cls);\n        } else {\n            el.className = className.replace(reg, \" \").trim();\n        }\n    }\n    return this;\n};\n\ndom.toggleClass = function (el, cls) {\n    let reg = new RegExp(\"\\\\s+\" + cls + \"\\\\s+\"),\n        className;\n    if (el) {\n        if (el.classList) {\n            el.classList.toggle(cls);\n        } else {\n            className = \" \" + el.className + \" \";\n            cls = \" \" + cls + \" \";\n            if (className.indexOf(cls) > -1) {\n                el.className = className.replace(reg, \" \").trim();\n            } else {\n                el.className += \" \" + cls;\n            }\n        }\n    }\n    return this;\n};\n\ndom.css = function (el, prop, val) {\n    let css = \"\";\n    if (!isUndefined(val)) {\n        el.style[prop] = val;\n    } else {\n        if (isObject(prop)) {\n            for (val in prop) {\n                css += val + \":\" + prop[val] + \";\";\n            }\n            el.style.cssText += css;\n        } else if (isString(prop)) {\n            return getComputedStyle(el).getPropertyValue(prop);\n        }\n    }\n    return this;\n};\n\n//选择元素， 只选中一个\ndom.selectElement = function (selector, context) {\n    let ret,\n        reg = /^#[^>~+\\[\\]\\s:]+$/; //匹配id选择器\n    context = context || doc;\n    if (selector) {\n        if (selector.nodeName || isWindow(selector)) {\n            ret = selector;\n        } else if (typeof selector === \"string\") {\n            if (reg.test(selector)) {\n                ret = doc.getElementById(selector.substring(1));\n            } else {\n                ret = context.querySelector(selector);\n            }\n        }\n    }\n    return ret;\n};\n\n//创建元素\ndom.createElement = function (name, attrs) {\n    let el = doc.createElement(name),\n        key;\n    if (isObject(attrs)) {\n        for (key in attrs) {\n            el.setAttribute(key, attrs[key]);\n        }\n    }\n    return el;\n};\n\n//添加元素事件\ndom._on = function (el, type, callback) {\n    let id = el.guid,\n        handler;\n    if (!id) {\n        id = guid++;\n        Object.defineProperty(el, \"guid\", {\n            value: id\n        });\n    }\n    handler = this.handlers[id];\n    if (!handler) {\n        handler = this.handlers[id] = {};\n        handler[type] = [];\n    } else if (!handler[type]) {\n        handler[type] = [];\n    }\n    handler[type].push(callback);\n    el.addEventListener(type, callback);\n};\n\ndom.on = function (selector, type, callback, off) {\n    let el = this.selectElement(selector),\n        i;\n    if (el) {\n        if (type) {\n            //添加多个事件，以空格分开\n            type = type.split(\" \");\n            i = type.length;\n            if (isFunction(callback)) {\n                for (; i--;) {\n                    let t = type[i];\n                    off ? this._off(el, t, callback) :\n                        this._on(el, t, callback);\n                }\n            } else if(off){\n                for (; i--;) {\n                    this._off(el, type[i]);\n                }\n            }\n        } else if(off) {\n            this._off(el);\n        }\n\n    }\n    return this;\n};\n\n//移除元素的事件\ndom._off = function (el, type, callback) {\n    let handlers = this.handlers[el.guid];\n    if (handlers) {\n        if (type && (handlers = handlers[type])) {\n            if (callback) {\n                for (let i = 0, len = handlers.length; i < len; i++ ) {\n                    if (handlers[i] === callback) {\n                        handlers.splice(i, 1);\n                        el.removeEventListener(type, callback);\n                        break;\n                    }\n                }\n            } else {\n                handlers.forEach(function (fn) {\n                    el.removeEventListener(type, fn);\n                });\n                dom.handlers[type] = [];\n            }\n        } else if (!type) {//如果没有type, 则移除该元素的所有事件\n            for (let key in handlers) {\n                this._off(el, key);\n            }\n        }\n    }\n};\n\ndom.off = function (selector, type, callback) {\n    return this.on(selector, type, callback, true);\n};\n\ndom.once = function (selector, type, callback) {\n    let cb, _this = this;\n    if (isFunction(callback)) {\n        cb = function () {\n            let args = Array.prototype.slice.call(arguments);\n            callback.apply(this, args);\n            _this.off(selector, type, cb);\n        };\n        this.on(selector, type, cb);\n    }\n    return this;\n};\n\n/**\n * 判断一个坐标是否再元素内部（例如鼠标移动后判鼠标指针是否再元素上）\n * @param {HTMLElement} el html元素\n * @param {number} x x偏移量\n * @param {number} y y偏移量\n * @param {boolean} relative 为true时候x,y相对视口的坐标,否则相对于元素\n */\ndom.isPositionInEl = function (el, x, y, relative) {\n    let rect = el.getBoundingClientRect();\n    if (relative) {\n        x = x - rect.left;\n        y = y - rect.top;\n    }\n    return x > 0 && x < rect.width && y > 0 && y < rect.height;\n};\n\nexport default dom;","import {isFunction, isString, toArray} from \"./global.js\";\nimport {isUndefined} from \"./global\";\n\nfunction CEvent(type) {\n    this.type = type;\n    this.data = null;\n    this.timeStamp = 0;\n}\n\nexport default class Subscriber {\n    constructor() {\n        Object.defineProperty(this, \"handlers\", {value: {}});\n    }\n\n    _on(type, fn) {\n        if (!this.handlers[type]) {\n            this.handlers[type] = [];\n        }\n        this.handlers[type].push(fn);\n    }\n\n    on(type, fn) {\n        if (isFunction(fn)) {\n            if (!isString(type)) {\n                throw new TypeError(\"事件类型只能为String\");\n            }\n            type = type.split(\" \");\n            for (let i = type.length; i--;) {\n                this._on(type[i], fn);\n            }\n        }\n        return this;\n    }\n\n    _off(type, fn) {\n        let handlers = this.handlers[type];\n        if (handlers) {\n            if (isFunction(fn)) {\n                for(let i = handlers.length; i--;) {\n                    if (fn === handlers[i]) {\n                        handlers.splice(i, 1);\n                        break;\n                    }\n                }\n            } else if (isUndefined(fn)) {\n                this.handlers[type] = [];\n            }\n        }\n    }\n\n    off(type, fn) {\n        let len = arguments.length;\n        if (len && isString(type)) {\n            let args = toArray(arguments, 1);\n            type = type.split(\" \");\n            for (let i = type.length; i--;) {\n                this._off.call(this, type[i], ...args);\n            }\n        } else if (!len) {\n            //没传参数则移除所有绑定\n            this.handlers = {};\n        }\n        return this;\n    }\n\n    once(type, fn) {\n        if (isFunction(fn)) {\n            let self = this,\n                f = function () {\n                    fn.apply(this, arguments);\n                    self.off(type, f);\n                };\n            this.on(type, f);\n        }\n    }\n\n    trigger(type) {\n        let args = toArray(arguments, 1),\n            h = this.handlers[type],\n            e;\n        if (h) {\n            e = new CEvent(type);\n            e.data = args;\n            e.timeStamp = Date.now();\n            args = [e].concat(args);\n            for (let i = h.length; i--; ) {\n                h[i].apply(this, args);\n            }\n        }\n        return this;\n    }\n}","import dom from \"../dom/index.js\";\n\nexport default class Loading {\n    constructor() {\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-loading rplayer-hide\"});\n    }\n\n    show() {\n        dom.removeClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    hide() {\n        dom.addClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    toggle() {\n        dom.toggleClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    init(target) {\n        target.appendChild(this.el);\n        return this;\n    }\n}\n","import dom from \"../dom/index.js\";\nimport {isFunction, noop} from \"../global.js\";\n\nexport default  class VideoError {\n    constructor() {\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-error rplayer-hide\"});\n        this.msgEl = dom.createElement(\"div\", {\"class\": \"rplayer-msg\"});\n        this.callback = noop();\n    }\n\n    show(msg) {\n        this.setMessage(msg);\n        dom.removeClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    hide() {\n        dom.addClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    setMessage(msg) {\n        this.msgEl.innerHTML = msg;\n        return this;\n    }\n\n    initEvent() {\n        dom.on(this.msgEl, \"click\", this.callback);\n        return this;\n    }\n\n    init(target, callback) {\n        this.el.appendChild(this.msgEl);\n        target.appendChild(this.el);\n        if (isFunction(callback)) {\n            this.callback = callback;\n        }\n        return this.initEvent();\n    }\n}","import dom from \"../../dom/index.js\";\nimport {doc, isUndefined, ERROR_TYPE} from \"../../global.js\";\nimport Subscriber from \"../../subscriber.js\";\n\nexport const VIDEO_LOADED_META = \"video.loaded.meta\";\nexport const VIDEO_TIME_UPDATE = \"video.time.update\";\nexport const VIDEO_SEEKING = \"video.seeking\";\nexport const VIDEO_LOAD_START = \"video.load.start\";\nexport const VIDEO_PROGRESS = \"video.progress\";\nexport const VIDEO_CAN_PLAY = \"video.can.play\";\nexport const VIDEO_ENDED = \"video.ended\";\nexport const VIDEO_ERROR = \"video.error\";\nexport const VIDEO_PLAYING = \"video.playing\";\nexport const VIDEO_PAUSE = \"video.pause\";\nexport const VIDEO_DBLCLICK = \"video.dblclick\";\nexport const VIDEO_CLICK = \"video.click\";\nexport const VIDEO_VOLUME_CHANGE = \"video.volume.change\";\n\nexport default class VideoControl extends Subscriber {\n    constructor(config) {\n        super();\n        this.config = config;\n        this.playedTime = null;\n        this.el = dom.createElement(\"video\", {\"class\": \"rplayer-video\"});\n        this.paused = this.el.paused;\n    }\n\n    setVolume(volume) {\n        //音量只能设置0-1的值\n        if (volume > 1) {\n            volume = volume / 100;\n        }\n        this.el.volume = volume;\n        return this;\n    }\n    \n    getVolume() {\n        return Math.floor(this.el.volume * 100);\n    }\n\n    mute(mute) {\n        this.el.muted = isUndefined(mute) ? true : !!mute;\n        return this;\n    }\n\n    isMuted() {\n        return this.el.muted;\n    }\n\n    autoPlay(play) {\n        this.el.autoplay = !!play;\n        return this;\n    }\n\n    play() {\n        this.paused = false;\n        if (this.el.networkState !== 2) {\n            //networkState=2（视频正在缓冲不能播放）时候反复点击播放按钮会报DomException错误\n            //此时不执行video元素的播放/暂停,只改变paused（video元素paused为只读）状态\n            //当触发canplay事件时，如果paused为true则进行播放\n            this.el.play();\n        }\n        return this;\n    }\n\n    pause() {\n        this.paused = true;\n        if (this.el.networkState !== 2) {\n            this.el.pause();\n        }\n    }\n\n    togglePlay() {\n        this.paused ? this.play() : this.pause();\n        return this;\n    }\n\n    isError() {\n        let err = this.el.error;\n        return err ? err.code : err;\n    }\n\n    loop(isLoop) {\n        this.el.loop = !!isLoop;\n        return this;\n    }\n\n    setPoster(poster) {\n        this.el.poster = poster;\n        return this;\n    }\n\n    setPreload(preload) {\n        this.el.preload = preload;\n        return this;\n    }\n\n    setCurrentTime(time, scale) {\n        let duration = this.getDuration();\n        if (scale) {\n            time = duration * scale;\n        }\n        this.el.currentTime = time;\n        return this;\n    }\n\n    getCurrentTime() {\n        return this.el.currentTime;\n    }\n\n    getDuration() {\n        return this.el.duration;\n    }\n\n    getBuffered(percent) {\n        let buffered = this.el.buffered,\n            len = buffered.length;\n        if (percent) {\n            //缓冲的百分比\n            return len ? buffered = buffered.end(len - 1) / this.getDuration() * 100 : null;\n        }\n        return buffered;\n    }\n\n    getReadyState() {\n        return this.el.readyState;\n    }\n\n    showControls() {\n        this.el.controls = true;\n        return this;\n    }\n\n    reload() {\n        this.el.load();\n        return this;\n    }\n\n    changeSource(src) {\n        let paused = this.paused;\n        if (this.source !== src) {\n            this.source = src;\n            this.initSource(src);\n        }\n        if (!paused) {\n            this.play(true);\n        }\n        return this;\n    }\n\n    getSource() {\n        return this.el.currentSrc;\n    }\n\n    initSource(source) {\n        let frag = doc.createDocumentFragment();\n        if (typeof source === \"string\") {\n            this.el.src = source;\n        } else if (Array.isArray(source)) {\n            this.el.innerHTML = \"\";\n            source.forEach(function (src) {\n                let sourceEl = dom.createElement(\"source\", {src: src});\n                frag.appendChild(sourceEl);\n            });\n            this.el.appendChild(frag);\n        }\n        return this;\n    }\n\n    handleError() {\n        let code = this.isError(),\n            err, message;\n        //出现错误保存当前播放进度，恢复后从当前进度继续播放\n        err = ERROR_TYPE[code];\n        switch (err) {\n            case \"MEDIA_ERR_ABORTED\":\n                message = \"出错了\";\n                break;\n            case \"MEDIA_ERR_NETWORK\":\n                message = \"网络错误或视频地址无效\";\n                break;\n            case \"MEDIA_ERR_DECODE\":\n            case \"MEDIA_ERR_SRC_NOT_SUPPORTED\":\n                message = \"解码失败,不支持的视频格式或地址无效\";\n        }\n        message += \",点击刷新\";\n        return {\n            code,\n            message\n        };\n    }\n\n    notify(type) {\n        let args = {\n                [VIDEO_LOADED_META]: [{duration: this.getDuration()}],\n                [VIDEO_TIME_UPDATE]: [this.getCurrentTime()],\n                [VIDEO_PROGRESS]: [this.getBuffered(true), this.getReadyState()],\n                [VIDEO_ERROR]: [this.handleError()],\n                [VIDEO_VOLUME_CHANGE]: [this.isMuted() ? 0 : this.getVolume()]\n            },\n            a = args[type] || [];\n        switch (type) {\n            case VIDEO_LOAD_START:\n                if (this.playedTime) {\n                    this.setCurrentTime(this.playedTime);\n                    this.playedTime = 0;\n                }\n                break;\n            case VIDEO_CAN_PLAY:\n                !this.paused && this.el.play();\n                break;\n            case VIDEO_PLAYING:\n                this.paused = false;\n                break;\n            case VIDEO_PAUSE:\n                this.paused = true;\n                break;\n            case VIDEO_ERROR:\n                this.playedTime = this.getCurrentTime();\n        }\n        return this.trigger(type, ...a);\n    }\n\n    initEvent() {\n        let el = this.el;\n        dom.on(el, \"loadedmetadata\", this.notify.bind(this, VIDEO_LOADED_META))\n            .on(el, \"timeupdate\", this.notify.bind(this, VIDEO_TIME_UPDATE))\n            .on(el, \"seeking\", this.notify.bind(this, VIDEO_SEEKING))\n            .on(el, \"loadstart\", this.notify.bind(this, VIDEO_LOAD_START))\n            .on(el, \"progress\", this.notify.bind(this, VIDEO_PROGRESS))\n            .on(el, \"canplay seeked\", this.notify.bind(this, VIDEO_CAN_PLAY))\n            .on(el, \"ended\", this.notify.bind(this, VIDEO_ENDED))\n            .on(el, \"error\", this.notify.bind(this, VIDEO_ERROR))\n            .on(el, \"playing\", this.notify.bind(this, VIDEO_PLAYING))\n            .on(el, \"pause\", this.notify.bind(this, VIDEO_PAUSE))\n            .on(el, \"volumechange\", this.notify.bind(this, VIDEO_VOLUME_CHANGE))\n            .on(el, \"dblclick\", this.notify.bind(this, VIDEO_DBLCLICK))\n            .on(el, \"click\", this.notify.bind(this, VIDEO_CLICK))\n            .on(el, \"contextmenu\", evt => evt.preventDefault());\n    }\n\n    init(target) {\n        let video = this.el,\n            text = doc.createTextNode(this.config.msg.toString());\n        this.source = this.config.source;\n        if (this.config.useNativeControls) {\n            this.showControls();\n        }\n        video.appendChild(text);\n        target.appendChild(video);\n        this.initSource(this.source)\n            .autoPlay(this.config.autoPlay)\n            .loop(this.config.loop)\n            .setPoster(this.config.poster)\n            .setPreload(this.config.preload)\n            .initEvent();\n        return this;\n    }\n}","import Subscriber from \"../subscriber.js\"\nimport {doc, isUndefined} from \"../global.js\";\nimport dom from \"../dom/index.js\";\n\nexport const SLIDER_MOVING = \"slider.moving\";\nexport const SLIDER_MOVE_DONE = \"slider.move.done\";\n\nexport default class Slider extends Subscriber {\n    constructor(vertical) {\n        super();\n        this.vertical = isUndefined(vertical) ? false : !!vertical;\n        this.moveDis = this.pos = null;\n        this.moving = false;\n        //滑块状态改变(是否可以滑动/点击),视频加载时候没有获取到元信息禁止改变进度\n        //初始默认可以滑动/点击\n        this.enabled = true;\n        this.track = dom.createElement(\"div\", {\"class\": \"rplayer-progress\"});\n        this.bar = dom.createElement(\"div\", {\"class\": \"rplayer-bar\"});\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-slider\"});\n    }\n\n\n    getPosition() {\n        let parent = this.el.parentNode,\n            rect = parent.getBoundingClientRect(),\n            pos = getComputedStyle(this.el);\n        return {\n            width: parseFloat(pos.width),\n            height: parseFloat(pos.height),\n            origLeft: parseFloat(pos.left),\n            origTop: parseFloat(pos.top),\n            maxX: rect.width,\n            maxY: rect.height\n        }\n    }\n\n    updateHPosition(val, scale) {\n        scale && (val = val * 100 + \"%\");\n        dom.css(this.bar, \"width\", val)\n            .css(this.el, \"left\", val);\n        return this;\n    }\n\n    updateVPosition(val, scale) {\n        scale && (val = val * 100 + \"%\");\n        dom.css(this.bar, \"height\", val)\n            .css(this.el, \"bottom\", val);\n        return this;\n    }\n\n    mouseDown(evt) {\n        //只有按鼠标左键时处理(evt.button=0)\n        if (!evt.button && this.enabled) {\n            let x = evt.clientX,\n                y = evt.clientY,\n                pos = this.getPosition(),\n                mouseMove = this.getMoveCallback().bind(this);\n            this.pos = {\n                width: pos.width,\n                height: pos.height,\n                offsetX: x - pos.origLeft,\n                offsetY: y - pos.origTop,\n                maxX: pos.maxX,\n                maxY: pos.maxY\n            };\n            dom.addClass(this.el, \"rplayer-moving\")\n                .on(doc, \"mousemove\", mouseMove)\n                .on(doc, \"mouseup\", this.mouseUp.bind(this))\n        }\n    }\n\n    moveVertical(x, y) {\n        let distance;\n        distance = this.pos.maxY - (y - this.pos.offsetY) - this.pos.height;\n        distance = distance < 0 ? 0 : distance > this.pos.maxY ? this.pos.maxY : distance;\n        distance = distance / this.pos.maxY;\n        this.updateVPosition(distance, true);\n        return distance;\n    }\n\n    moveHorizontal(x) {\n        let distance;\n        distance = x - this.pos.offsetX;\n        distance = distance < 0 ? 0 : distance > this.pos.maxX ? this.pos.maxX : distance;\n        distance = distance / this.pos.maxX;\n        this.updateHPosition(distance, true);\n        return distance;\n    }\n\n    mouseMove(evt, fn) {\n        let x = evt.clientX,\n            y = evt.clientY,\n            distance = fn.call(this, x, y);\n        this.moving = true;\n        this.trigger(SLIDER_MOVING, this.moveDis = distance);\n    }\n\n    getMoveCallback() {\n        return this.vertical ?\n            evt => this.mouseMove(evt, this.moveVertical) :\n            evt => this.mouseMove(evt, this.moveHorizontal);\n    }\n\n    mouseUp() {\n        dom.off(doc, \"mousemove mouseup\")\n            .removeClass(this.el, \"rplayer-moving\");\n        if (this.moving) {\n            this.trigger(SLIDER_MOVE_DONE, this.moveDis);\n            setTimeout(() => this.moving = false);\n        }\n    }\n\n    clickTrack(evt) {\n        //移动滑块鼠标释放时会触发父元素点击事件,可能会导致鼠标释放后滑块位置改变\n        //如果移动滑块/被禁用则点击事件不做处理\n        if (!this.moving && this.enabled) {\n            let rect = this.track.getBoundingClientRect(),\n                x = evt.clientX,\n                y = evt.clientY,\n                eType = \"slider.moving\";\n            if (this.vertical) {\n                rect = (rect.height - y + rect.top) / rect.height;\n                this.updateVPosition(rect, true);\n            } else {\n                rect = (x - rect.left) / rect.width;\n                eType = \"slider.move.done\";\n                this.updateHPosition(rect, true);\n            }\n            this.trigger(eType, rect);\n        }\n    }\n\n    initEvent() {\n        dom.on(this.el, \"mousedown\", this.mouseDown.bind(this))\n            .on(this.track, \"click\", this.clickTrack.bind(this));\n        return this;\n    }\n\n    init(target) {\n        let cls = {\n            track: \"rplayer-video-track\",\n            bar: \"rplayer-video-progress\",\n            slider: \"rplayer-video-slider\"\n        };\n        if (this.vertical) {\n            cls = {\n                track: \"rplayer-volume-progress\",\n                bar: \"rplayer-volume-value\",\n                slider: \"rplayer-volume-slider\"\n            }\n        }\n        dom.addClass(this.track, cls.track)\n            .addClass(this.bar, cls.bar)\n            .addClass(this.el, cls.slider);\n        this.track.appendChild(this.bar);\n        this.track.append(this.el);\n        target.appendChild(this.track);\n        return this.initEvent();\n    };\n}","import dom from \"../dom/index.js\";\nimport {isObject} from \"../global.js\";\n\nexport default class Popup {\n    constructor(cls, autoHide) {\n        this.el = dom.createElement(\"div\", {\"class\": `rplayer-popup-info rplayer-hide ${cls}`});\n        this.visible = false;\n        this.autoHide = !!autoHide;\n        this.timer = null;\n    }\n\n    show(msg) {\n        this.visible = true;\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n        }\n        if (this.autoHide) {\n            this.timer = setTimeout(() => this.hide(), 3000);\n        }\n        dom.removeClass(this.el, \"rplayer-hide\");\n        msg && this.updateText(msg);\n        return this;\n    }\n\n    hide() {\n        this.visible = false;\n        dom.addClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    updatePosition(prop) {\n        let pos = {\n            left: \"left\",\n            right: \"right\",\n            top: \"top\",\n            bottom: \"bottom\"\n        };\n        if(isObject(prop)) {\n            for (let key in prop) {\n                if (pos[key]) {\n                    dom.css(this.el, key, prop[key]);\n                }\n            }\n        }\n        return this;\n    }\n\n    updateText(content) {\n        this.el.innerHTML = content;\n        return this;\n    }\n\n    getSize(prop) {\n        //隐藏元素获取不到尺寸信息，隐藏时先将元素显示出来获取之后再隐藏\n        let visible = this.visible;\n        !visible && this.show();\n        let style = getComputedStyle(this.el);\n        !visible && this.hide();\n        return prop ?\n            parseFloat(style[prop]) :\n            {\n                left: parseFloat(style.left),\n                right: parseFloat(style.right),\n                top: parseFloat(style.top),\n                bottom: parseFloat(style.bottom),\n                width: parseFloat(style.width),\n\n            }\n    }\n\n    width() {\n        return this.getSize(\"width\");\n    }\n\n    height() {\n        return this.getSize(\"height\");\n    }\n\n    init(target) {\n        target.appendChild(this.el);\n        return this;\n    }\n}","import dom from \"../../dom/index.js\";\nimport Slider, {SLIDER_MOVE_DONE} from \"../slider.js\";\nimport Popup from \"../../message/popup.js\";\nimport {convertTime} from \"../../global.js\";\nimport Subscriber from \"../../subscriber.js\";\n\n//滑动/点击改变进度后设置视频播放时间\nexport const VIDEO_PROGRESS_UPDATE = \"video.progress.update\";\n//视频播放时时间改变\nexport const VIDEO_PROGRESS_UPDATED = \"video.progress.updated\";\nexport const VIDEO_PROGRESS_BUFFER = \"video.progress.buffer\";\n\nexport default class VideoProgress extends Subscriber {\n    constructor() {\n        super();\n        this.slider = new Slider();\n        this.panel = dom.createElement(\"div\", {\"class\": \"rplayer-progress-panel\"});\n        this.bufferEl = dom.createElement(\"div\", {\"class\": \"rplayer-bufferd-bar\"});\n        this.popup = new Popup(\"rplayer-popup-video-info\");\n        this.currentTime = this.duration = 0;\n    }\n\n    update(current, sliderMove) {\n        if (this.currentTime !== current) {\n            this.currentTime = current;\n            let percent = current / this.duration * 100 || 0;\n            !sliderMove && this.slider.updateHPosition(percent + \"%\");\n        }\n        return this;\n    }\n\n    updateByStep(step) {\n        let currentTime = this.currentTime,\n            duration = this.duration;\n        if (duration) {\n            currentTime += step;\n            this.currentTime = currentTime < 0 ? 0 : currentTime > duration ? duration : currentTime;\n            this.trigger(VIDEO_PROGRESS_UPDATE, this.currentTime);\n        }\n        return this;\n    }\n\n    enable(enable) {\n        this.slider.enabled = !!enable;\n        return this;\n    }\n\n    buffer(buffered) {\n        dom.css(this.bufferEl, buffered + \"%\");\n    }\n\n    mouseMove(evt) {\n        if (this.duration) {\n            this.popup.show();\n            let rect = this.panel.getBoundingClientRect(),\n                distance = evt.clientX - rect.left,\n                width = this.popup.width(),\n                left = distance - width / 2;\n            width = rect.width - width;\n            left = left < 0 ? 0 : left > width ? width : left;\n            width = distance / rect.width;\n            this.popup\n                .updatePosition({left: left + \"px\"})\n                .updateText(convertTime(width * this.duration));\n        }\n    }\n\n    mouseOut() {\n        this.popup.hide();\n    }\n\n    initEvent() {\n        //滑动改变进度/点击进度条改变进度\n        this.slider.on(SLIDER_MOVE_DONE, (evt, distance) => {\n            let time = distance * this.duration;\n            this.update(time);\n            this.trigger(VIDEO_PROGRESS_UPDATE, time);\n        });\n        dom.on(this.panel, \"mouseover mousemove\", this.mouseMove.bind(this))\n            .on(this.panel, \"mouseout\", this.mouseOut.bind(this));\n        this.on(VIDEO_PROGRESS_UPDATED, (evt, time) => this.update(time))\n            .on(VIDEO_PROGRESS_BUFFER, (evt, buffer) => this.buffer(buffer))\n        return this;\n    }\n\n    init(target) {\n        let el = this.panel;\n        el.appendChild(this.bufferEl);\n        this.slider.init(el);\n        this.popup.init(el);\n        target.appendChild(el);\n        return this.initEvent();\n    }\n}","import dom from \"../dom/index.js\";\nimport Slider, {SLIDER_MOVING} from \"./slider.js\";\nimport {doc} from \"../global\";\nimport Subscriber from \"../subscriber.js\";\n\nexport const VOLUME_CONTROL_UPDATE = \"volume.control.update\";\nexport const VOLUME_CONTROL_MUTE = \"volume.control.mute\";\n\nexport default class VolumeControl extends Subscriber {\n    constructor(volume) {\n        super();\n        this.panel = dom.createElement(\"div\", {\"class\": \"rplayer-volume-popup rplayer-hide\"});\n        this.valueEl = dom.createElement(\"div\", {\"class\": \"rplayer-current-volume\"});\n        this.muteBtn = dom.createElement(\"button\", {\"class\": \"rplayer-mute volume-1\"});\n        this.showBtn = dom.createElement(\"button\", {\"class\": \"rplayer-audio-btn volume-1\"});\n        this.slider = new Slider(true);\n        this.volume = volume;\n        this.muted = false;\n    }\n\n    show() {\n        dom.removeClass(this.panel, \"rplayer-hide\");\n        return this;\n    }\n\n    hide() {\n        dom.addClass(this.panel, \"rplayer-hide\");\n        return this;\n    }\n\n    toggle(evt) {\n        dom.toggleClass(this.panel, \"rplayer-hide\");\n        //document click事件点击音量设置面板之外隐藏,如果不阻止冒泡则面板显示不出来\n        evt.stopPropagation();\n        return this;\n    }\n\n    updateVolume(volume, sliderMove) {\n        this.volume = volume;\n        this.updateStyle(this.volume, sliderMove);\n        this.trigger(VOLUME_CONTROL_UPDATE, this.volume);\n        return this;\n    }\n\n    updateVolumeByStep(step) {\n        let volume = this.volume + step;\n        volume = volume > 100 ? 100 : volume < 0 ? 0 : volume;\n        this.updateVolume(volume);\n    }\n\n    updateStyle(volume, sliderMove) {\n        let muteCls = this.muteBtn.className,\n            showCls = this.showBtn.className,\n            reg = /volume-\\S+/;\n        muteCls = muteCls.replace(reg, \"\");\n        showCls = showCls.replace(reg, \"\");\n        if (!volume) {\n            reg= \"volume-mute\";\n        } else if (volume <= 33) {\n            reg= \"volume-1\";\n        } else if (volume <= 66) {\n            reg= \"volume-2\";\n        } else {\n            reg= \"volume-3\";\n        }\n        this.muteBtn.className = muteCls + reg;\n        this.showBtn.className = showCls + reg;\n        this.valueEl.innerHTML = volume;\n        //如果通过移动滑块改变音量则不重复改变slider的位置\n        !sliderMove && this.slider.updateVPosition(volume + \"%\");\n        return this;\n    }\n\n    mute() {\n        this.muted = !this.muted;\n        this.muted ? this.updateStyle(0) : this.updateStyle(this.volume);\n        this.trigger(VOLUME_CONTROL_MUTE, this.muted);\n    }\n\n    initEvent() {\n        dom.on(this.muteBtn, \"click\", this.mute.bind(this))\n            .on(this.panel, \"mouseleave\", this.hide.bind(this))\n            .on(this.showBtn, \"click\", this.toggle.bind(this))\n            .on(doc, \"click\", evt => {\n                let tgt = evt.target;\n                //点击页面其他地方（点击的不是音量设置面板或者面板内的元素）则隐藏音量面板\n                if (tgt !== this.panel && !this.panel.contains(tgt)) {\n                    this.hide();\n                }\n            });\n        this.slider.on(SLIDER_MOVING, (evt, distance) => {\n            this.updateVolume(Math.floor(100 * distance), true);\n        });\n        return this;\n    }\n\n    init(target) {\n        let panel = dom.createElement(\"div\", {\"class\": \"rplayer-audio-control rplayer-rt\"});\n        this.panel.appendChild(this.valueEl);\n        this.slider.init(this.panel);\n        this.panel.appendChild(this.muteBtn);\n        panel.appendChild(this.showBtn);\n        panel.append(this.panel);\n        target.appendChild(panel);\n        this.updateVolume(this.volume)\n            .initEvent();\n        return this;\n    }\n}","let fsApi = (function () {\n    let fullScreenApi = [\n            //W3C\n            [\n                \"requestFullscreen\",\n                \"exitFullscreen\",\n                \"fullscreenElement\",\n                \"fullscreenEnabled\",\n                \"fullscreenchange\",\n                \"fullscreenerror\"\n            ],\n            // WebKit\n            [\n                \"webkitRequestFullscreen\",\n                \"webkitExitFullscreen\",\n                \"webkitFullscreenElement\",\n                \"webkitFullscreenEnabled\",\n                \"webkitfullscreenchange\",\n                \"webkitfullscreenerror\"\n            ],\n            // Firefox\n            [\n                \"mozRequestFullScreen\",\n                \"mozCancelFullScreen\",\n                \"mozFullScreenElement\",\n                \"mozFullScreenEnabled\",\n                \"mozfullscreenchange\",\n                \"mozfullscreenerror\"\n            ],\n            // IE\n            [\n                \"msRequestFullscreen\",\n                \"msExitFullscreen\",\n                \"msFullscreenElement\",\n                \"msFullscreenEnabled\",\n                \"MSFullscreenChange\",\n                \"MSFullscreenError\"\n            ]\n\n        ],\n        fsApi = null,\n        defApi = fullScreenApi[0],\n        tmp, support;\n    for (let i = 0, len = fullScreenApi.length; i < len; i++) {\n        tmp = fullScreenApi[i];\n        if (tmp[1] in document) {\n            support = true;\n            break;\n        }\n    }\n\n    if (support) {\n        fsApi = {};\n        tmp.forEach(function (prop, i) {\n            fsApi[defApi[i]] = prop;\n        });\n    }\n    return fsApi;\n})();\n\nexport default fsApi;","import dom from \"../../dom/index.js\";\nimport {doc} from \"../../global.js\";\nimport fsApi from \"../../dom/fullscreen_api.js\";\n\nexport default class FullScreen {\n    constructor(el) {\n        this.el = el;\n        this.isFullScreen = false;\n        this.btn = dom.createElement(\"button\", {\"class\": \"rplayer-fullscreen-btn rplayer-rt\"});\n    }\n    request() {\n        this.isFullScreen = true;\n        fsApi ?\n            this.el[fsApi.requestFullscreen]() :\n            this.fullPage();\n        dom.addClass(this.el, \"rplayer-fullscreen\")\n            .addClass(this.btn, \"rplayer-fullscreen\");\n        return this;\n    }\n\n    exit() {\n        this.isFullScreen = false;\n        fsApi ?\n            doc[fsApi.exitFullscreen]() :\n            this.fullPage(true);\n        dom.removeClass(this.btn, \"rplayer-fullscreen\")\n            .removeClass(this.el, \"rplayer-fullscreen\");\n        return this;\n    }\n\n    toggle() {\n        return this.isFullScreen = !this.isFullScreen ?\n            this.request() :\n            this.exit();\n    }\n\n    fullPage(exit) {\n        //不支持全屏的浏览器铺满页面可视区域\n        exit ?\n            dom.removeClass(this.el, \"rplayer-fixed\") :\n            dom.addClass(this.el, \"rplayer-fixed\");\n        return this;\n    }\n\n    initEvent() {\n        if (fsApi) {\n            dom.on(doc, fsApi.fullscreenchange, () => {\n                if (!doc[fsApi.fullscreenElement]) {\n                    this.exit();\n                }\n            }).on(doc, fsApi.fullscreenerror, () => {\n                this.exit();\n            });\n        }\n        dom.on(this.btn, \"click\", this.toggle.bind(this));\n        return this;\n    }\n\n    init(target) {\n        target.appendChild(this.btn);\n        return this.initEvent();\n    }\n}\n","import dom from \"../dom/index.js\";\nimport {doc, convertTime} from \"../global.js\";\n\nexport default class TimeInfo {\n    constructor() {\n        this.currentEl = dom.createElement(\"span\", {\"class\": \"rplayer-current-time\"});\n        this.totalEl = dom.createElement(\"span\", {\"class\": \"rplayer-total-time\"});\n    }\n\n    updateCurrentTime(time) {\n        this.currentEl.innerHTML = convertTime(time);\n        return this;\n    }\n\n    updateTotalTime(time) {\n        this.totalEl.innerHTML = convertTime(time);\n        return this;\n    }\n\n    init(target) {\n        let el = dom.createElement(\"span\", {\"class\": \"rplayer-time-info\"}),\n            text = doc.createTextNode(\"/\");\n        this.currentEl.innerHTML = this.totalEl.innerHTML = \"00:00\";\n        el.appendChild(this.currentEl);\n        el.appendChild(text);\n        el.appendChild(this.totalEl);\n        target.appendChild(el);\n        return this;\n    }\n}","import VideoProgress, {\n    VIDEO_PROGRESS_UPDATED,\n    VIDEO_PROGRESS_UPDATE,\n    VIDEO_PROGRESS_BUFFER,\n} from \"./video/video_progress.js\";\nimport VolumeControl, {VOLUME_CONTROL_MUTE, VOLUME_CONTROL_UPDATE} from \"./volume_control.js\";\nimport FullScreen from \"./video/fullscreen.js\";\nimport Popup from \"../message/popup.js\";\nimport TimeInfo from \"../message/time_info.js\";\nimport dom from \"../dom/index.js\";\nimport {KEY_MAP} from \"../global.js\";\nimport {\n    VIDEO_VOLUME_CHANGE,\n    VIDEO_LOAD_START,\n    VIDEO_LOADED_META,\n    VIDEO_PROGRESS,\n    VIDEO_TIME_UPDATE,\n    VIDEO_PAUSE,\n    VIDEO_PLAYING,\n    VIDEO_CLICK,\n    VIDEO_DBLCLICK\n} from \"./video/video_control.js\";\n\n\nexport default class Controls {\n    constructor(parent, media, volume) {\n        this.parentEl = parent;\n        this.media = media;\n        this.timer = null;\n        //视频是否允许点击播放/改变进度\n        //第一次开始加载是不允许改变\n        this.enabled = false;\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-controls\"});\n        this.playBtn = dom.createElement(\"button\", {\"class\": \"rplayer-play-btn\"});\n        this.volumeControl = new VolumeControl(volume);\n        this.timeInfo = new TimeInfo();\n        this.fullScreen = new FullScreen(parent);\n        this.progress = new VideoProgress();\n        this.volumePopup = new Popup(\"rplayer-popup-volume-info\", true);\n    }\n\n    show(evt = {}) {\n        let error = this.media.isError();\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n        }\n        if (!error) {\n            let mouseX = evt.clientX;\n            let mouseY = evt.clientY;\n            this.visible = true;\n            dom.removeClass(this.el, \"rplayer-hide\");\n            this.timer = setTimeout(() => {\n                this.hide(mouseX, mouseY);\n            }, 5000);\n        }\n        return this;\n    }\n\n    hide(mouseX, mouseY) {\n        if (!dom.isPositionInEl(this.el, mouseX, mouseY, true)) {\n            dom.addClass(this.el, \"rplayer-hide\");\n        }\n        return this;\n    }\n\n    keyDown(evt) {\n        let key = evt.key.toLowerCase(),\n            regUpOrDown = /(?:up)|(?:down)/,\n            regLeftOrRight = /(?:left)|(?:right)/,\n            regEsc = /esc/,\n            regSpace = /\\s|(?:spacebar)/,\n            tmp = KEY_MAP[key];\n        if (tmp) {\n            if (regLeftOrRight.test(key)) {\n                this.progress.updateByStep(tmp);\n            } else if (regUpOrDown.test(key)) {\n                this.volumeControl.updateVolumeByStep(tmp);\n            } else if (regEsc.test(key)) {\n                this.fullScreen.exit();\n            } else if (regSpace.test(key)) {\n                this.playControl.toggle();\n            }else {\n                this.fullScreen.toggle();\n            }\n        }\n        evt.preventDefault();\n    }\n\n    showVolumePopup(volume) {\n        let text = `当前音量: ${volume}`;\n        if (volume === 0) {\n            text = \"静音\";\n        }\n        this.volumePopup.show(text);\n        return this;\n    }\n\n    updateMeta(meta) {\n        let duration = meta.duration,\n            progress = this.progress;\n        this.timeInfo.updateTotalTime(duration);\n        progress.enable(this.enabled = true);\n        progress.duration = duration;\n    }\n\n    updateTime(current) {\n        this.timeInfo.updateCurrentTime(current);\n        this.progress.trigger(VIDEO_PROGRESS_UPDATED, current)\n    }\n\n    updateProgress(time) {\n        this.media.setCurrentTime(time);\n        this.timeInfo.updateCurrentTime(time);\n    }\n\n    play() {\n        dom.addClass(this.playBtn, \"rplayer-paused\");\n        return this;\n    }\n\n    pause() {\n        dom.removeClass(this.playBtn, \"rplayer-paused\");\n        return this;\n    }\n\n    togglePlay() {\n        if (this.enabled) {\n            this.media.togglePlay();\n            this.media.paused ? this.pause() : this.play();\n        }\n    }\n\n    initEvent() {\n        let media = this.media,\n            progress = this.progress,\n            toggle = this.togglePlay.bind(this);\n        media.on(VIDEO_VOLUME_CHANGE, (evt, volume) => this.showVolumePopup(volume))\n            .on(VIDEO_LOAD_START, () => {\n                this.pause();\n                this.progress.enable(this.enabled = false)\n            })\n            .on(VIDEO_LOADED_META, (evt, meta) => this.updateMeta(meta))\n            .on(VIDEO_TIME_UPDATE, (evt, current) => this.updateTime(current))\n            .on(VIDEO_PROGRESS, (evt, buffered) => progress.trigger(VIDEO_PROGRESS_BUFFER, buffered))\n            .on(VIDEO_PLAYING, this.play.bind(this))\n            .on(VIDEO_PAUSE, this.pause.bind(this))\n            .on(VIDEO_CLICK, toggle)\n            .on(VIDEO_DBLCLICK, () => this.fullScreen.toggle());\n        progress.on(VIDEO_PROGRESS_UPDATE, (evt, time) => this.updateProgress(time));\n        this.volumeControl\n            .on(VOLUME_CONTROL_MUTE, (evt, muted) => media.mute(muted))\n            .on(VOLUME_CONTROL_UPDATE, (evt, volume) => media.setVolume(volume));\n        dom.on(this.parentEl, \"keydown\", this.keyDown.bind(this))\n            .on(this.parentEl, \"mousemove\", this.show.bind(this))\n            .on(this.playBtn, \"click\", toggle);\n        return this;\n    }\n\n    init() {\n        let settingsPanel = dom.createElement(\"div\", {\"class\": \"rplayer-settings rplayer-rt\"}),\n            playControl = dom.createElement(\"div\", {\"class\": \"rplayer-play-control rplayer-lf\"}),\n            el = this.el;\n        this.fullScreen.init(settingsPanel);\n        this.volumeControl.init(settingsPanel);\n        playControl.appendChild(this.playBtn);\n        this.timeInfo.init(playControl);\n        this.progress.init(el);\n        this.volumePopup.init(el);\n        el.appendChild(playControl);\n        el.appendChild(settingsPanel);\n        this.parentEl.appendChild(el);\n        this.show();\n        return this.initEvent();\n    }\n}","import dom from \"./dom/index.js\";\nimport {DEFAULT_OPTIONS, isObject, isUndefined, removeProp} from \"./global.js\";\nimport Subscriber from \"./subscriber.js\";\nimport Loading from \"./message/loading.js\";\nimport VideoError from \"./message/error.js\";\nimport VideoControl, {\n    VIDEO_CAN_PLAY,\n    VIDEO_ENDED,\n    VIDEO_ERROR,\n    VIDEO_LOAD_START,\n    VIDEO_PROGRESS,\n    VIDEO_SEEKING,\n} from \"./controls/video/video_control.js\";\nimport Controls from \"./controls/index.js\";\n\nconst DEFAULT_HEIGHT = 500;\n\nfunction handleConfig(options) {\n    return isObject(options) ?\n        {\n            autoPlay: !!options.autoPlay,\n            loop: !!options.loop,\n            defaultVolume: Math.abs(parseInt(options.defaultVolume)) || DEFAULT_OPTIONS.defaultVolume,\n            msg: options.msg || DEFAULT_OPTIONS.msg,\n            poster: options.poster || DEFAULT_OPTIONS.poster,\n            preload: options.preload || DEFAULT_OPTIONS.preload,\n            source: options.source,\n            useNativeControls: isUndefined(options.useNativeControls) ? false : options.useNativeControls\n        } : DEFAULT_OPTIONS;\n}\n\nexport default class RPlayer extends Subscriber {\n    constructor(selector, options) {\n        let target = dom.selectElement(selector),\n            config = handleConfig(options);\n        super();\n        if (!config.source) {\n            throw new Error(\"没有设置视频链接\");\n        }\n        if (!target) {\n            throw new Error(\"未选中任何元素\");\n        }\n        this.target = target;\n        this.loading = new Loading();\n        this.video = new VideoControl(config);\n        this.container = dom.createElement(\"div\", {\n            \"tabIndex\": 100, //使元素能够获取焦点\n            \"class\": \"rplayer-container\"\n        });\n        //播放控制与原生控制二选一，如果设置了useNativeControls为true，则优先使用原生控制\n        if((isUndefined(options.controls) ? true : !!options.controls) && !config.useNativeControls) {\n            this.controls = new Controls(this.container, this.video, config.defaultVolume);\n        }\n    }\n\n    buffer(buffered, readyState) {\n        if (readyState < 3) {\n            this.loading.show();\n        }\n    }\n\n    playEnd() {\n        this.trigger(\"play.end\");\n    }\n\n    handleError(error) {\n        if (!this.error) {\n            this.error = new VideoError();\n            this.error.init(this.container, this.refresh.bind(this));\n        }\n        this.loading.hide();\n        this.error.show(error.message);\n        return this;\n    }\n\n    refresh() {\n        this.video.reload();\n        this.error.hide();\n    };\n\n    initEvent() {\n        this.video\n            .on(VIDEO_LOAD_START, () => this.loading.show())\n            .on(VIDEO_PROGRESS, (evt, buffered, readyState) => this.buffer(buffered, readyState))\n            .on(VIDEO_SEEKING, () => this.loading.show())\n            .on(VIDEO_CAN_PLAY, () => this.loading.hide())\n            .on(VIDEO_ENDED, this.playEnd.bind(this))\n            .on(VIDEO_ERROR, (evt, error) => this.handleError(error));\n        return this;\n    };\n\n    getSource() {\n        return this.video.getSource();\n    };\n\n    updateSource(src) {\n        this.video.changeSource(src);\n    };\n\n    initialize() {\n        let container = this.container,\n            height = parseInt(getComputedStyle(this.target).height);\n        if (!container.parentNode) {\n            dom.css(container, \"height\", (height || DEFAULT_HEIGHT) + \"px\");\n            this.video.init(container);\n            this.loading.init(container);\n            this.controls && this.controls.init();\n            this.target.appendChild(container);\n            this.initEvent();\n        }\n        return this;\n    };\n}\n\nRPlayer.init = function (selector, options) {\n    return new RPlayer(selector, options).initialize();\n};"],"names":["DEFAULT_OPTIONS","ERROR_TYPE","TYPE","VOLUME_STEP","VIDEO_STEP","KEY_MAP","doc","document","isType","Object","prototype","toString","call","obj","type","isFunction","isObject","isString","isUndefined","isWindow","window","toArray","likeArr","start","Array","isArray","slice","length","noop","convertTime","time","changeLen","num","str","h","m","s","Math","ceil","floor","dom","guid","hasClass","el","cls","classList","contains","className","indexOf","addClass","add","removeClass","reg","RegExp","remove","replace","trim","toggleClass","toggle","css","prop","val","style","cssText","getComputedStyle","getPropertyValue","selectElement","selector","context","ret","nodeName","test","getElementById","substring","querySelector","createElement","name","attrs","key","setAttribute","_on","callback","id","handler","defineProperty","handlers","push","addEventListener","on","off","i","split","t","_off","len","splice","removeEventListener","forEach","fn","once","cb","_this","args","arguments","apply","isPositionInEl","x","y","relative","rect","getBoundingClientRect","left","top","width","height","CEvent","data","timeStamp","Subscriber","value","TypeError","self","f","e","Date","now","concat","Loading","target","appendChild","VideoError","msgEl","msg","setMessage","innerHTML","initEvent","VIDEO_LOADED_META","VIDEO_TIME_UPDATE","VIDEO_SEEKING","VIDEO_LOAD_START","VIDEO_PROGRESS","VIDEO_CAN_PLAY","VIDEO_ENDED","VIDEO_ERROR","VIDEO_PLAYING","VIDEO_PAUSE","VIDEO_DBLCLICK","VIDEO_CLICK","VIDEO_VOLUME_CHANGE","VideoControl","config","playedTime","paused","volume","mute","muted","play","autoplay","networkState","pause","err","error","code","isLoop","loop","poster","preload","scale","duration","getDuration","currentTime","percent","buffered","end","readyState","controls","load","src","source","initSource","currentSrc","frag","createDocumentFragment","sourceEl","isError","message","getCurrentTime","getBuffered","getReadyState","handleError","isMuted","getVolume","a","setCurrentTime","trigger","notify","bind","evt","preventDefault","video","text","createTextNode","useNativeControls","showControls","autoPlay","setPoster","setPreload","SLIDER_MOVING","SLIDER_MOVE_DONE","Slider","vertical","moveDis","pos","moving","enabled","track","bar","parent","parentNode","parseFloat","button","clientX","clientY","getPosition","mouseMove","getMoveCallback","origLeft","origTop","maxX","maxY","mouseUp","distance","offsetY","updateVPosition","offsetX","updateHPosition","moveVertical","moveHorizontal","eType","mouseDown","clickTrack","slider","append","Popup","autoHide","visible","timer","setTimeout","hide","updateText","content","show","right","bottom","getSize","VIDEO_PROGRESS_UPDATE","VIDEO_PROGRESS_UPDATED","VIDEO_PROGRESS_BUFFER","VideoProgress","panel","bufferEl","popup","current","sliderMove","step","enable","updatePosition","update","mouseOut","buffer","init","VOLUME_CONTROL_UPDATE","VOLUME_CONTROL_MUTE","VolumeControl","valueEl","muteBtn","showBtn","stopPropagation","updateStyle","updateVolume","muteCls","showCls","tgt","fsApi","fullScreenApi","defApi","tmp","support","FullScreen","isFullScreen","btn","requestFullscreen","fullPage","exitFullscreen","request","exit","fullscreenchange","fullscreenElement","fullscreenerror","TimeInfo","currentEl","totalEl","Controls","media","parentEl","playBtn","volumeControl","timeInfo","fullScreen","progress","volumePopup","mouseX","mouseY","toLowerCase","regUpOrDown","regLeftOrRight","regEsc","regSpace","updateByStep","updateVolumeByStep","playControl","meta","updateTotalTime","updateCurrentTime","togglePlay","showVolumePopup","updateMeta","updateTime","updateProgress","setVolume","keyDown","settingsPanel","DEFAULT_HEIGHT","handleConfig","options","abs","parseInt","defaultVolume","RPlayer","Error","loading","container","refresh","reload","playEnd","getSource","changeSource","initialize"],"mappings":"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"}