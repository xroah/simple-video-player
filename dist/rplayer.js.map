{"version":3,"file":"rplayer.js","sources":["../src/scripts/global.js","../src/scripts/dom/index.js","../src/scripts/subscriber.js","../src/scripts/message/loading.js","../src/scripts/message/error.js","../src/scripts/controls/video/video_control.js","../src/scripts/controls/slider.js","../src/scripts/message/popup.js","../src/scripts/controls/video/video_progress.js","../src/scripts/controls/volume_control.js","../src/scripts/dom/fullscreen_api.js","../src/scripts/controls/video/fullscreen.js","../src/scripts/message/time_info.js","../src/scripts/controls/video/play_control.js","../src/scripts/controls/index.js","../src/scripts/index.js"],"sourcesContent":["\"use strict\";\nconst DEFAULT_OPTIONS = {\n        autoPlay: false,\n        defaultVolume: 50,\n        loop: false,\n        poster: \"\",\n        preload: \"metadata\",\n        source: \"\",\n        msg: \"\",\n        useNativeControls: false\n    },\n    ERROR_TYPE = { //视频播放错误类型\n        \"1\": \"MEDIA_ERR_ABORTED\",\n        \"2\": \"MEDIA_ERR_NETWORK\",\n        \"3\": \"MEDIA_ERR_DECODE\",\n        \"4\": \"MEDIA_ERR_SRC_NOT_SUPPORTED\"\n    },\n    TYPE = {\n        function: \"[object Function]\",\n        object: \"[object Object]\",\n        string: \"[object String]\",\n        undef: \"[object Undefined]\"\n    },\n    VOLUME_STEP = 5,\n    VIDEO_STEP = 10,\n    KEY_MAP = {\n        \"up\": VOLUME_STEP, //IE\n        \"arrowup\": VOLUME_STEP,\n        \"down\": -VOLUME_STEP, //IE\n        \"arrowdown\": -VOLUME_STEP,\n        \"left\": -VIDEO_STEP, //IE\n        \"arrowleft\": -VIDEO_STEP,\n        \"right\": VIDEO_STEP, //IE\n        \"arrowright\": VIDEO_STEP,\n        \"esc\": \"esc\", //IE\n        \"escape\": \"escape\",\n        \" \": \"space\",\n        \"spacebar\": \"space\", //IE\n        \"enter\": \"enter\"\n    };\nlet doc = document,\n    isType = type => obj => Object.prototype.toString.call(obj) === TYPE[type],\n    isFunction = isType(\"function\"),\n    isObject = isType(\"object\"),\n    isString = isType(\"string\"),\n    isUndefined = isType(\"undef\"),\n    isWindow = obj => obj && obj.window === obj;\n\nexport function extend(target, source) {\n    if (arguments.length) {\n        for (let key in source) {\n            let copy = source[key],\n                t = target[key];\n            if (isObject(copy) && isObject(t)) {\n                extend(target[key], source[key]);\n            } else {\n                target[key] = copy;\n            }\n        }\n    }\n    return target;\n}\n\nexport function toArray(likeArr, start = 0) {\n    return Array.isArray(likeArr) ? likeArr.slice(start) :\n        likeArr.length ?  Array.prototype.slice.call(likeArr, start) : [];\n}\n\nexport function removeProp(obj, prop) {\n    if (prop) {\n        try{\n            delete obj[prop];\n        }catch (e){}\n    } else {\n        for (prop in obj) {\n            delete obj[prop];\n        }\n    }\n}\n\nexport function noop() {\n    return function () {};\n}\n\nexport function convertTime(time) {\n    let changeLen = num => num < 10 ? \"0\" + num : num.toString(),\n        str, h, m, s;\n    time = Math.ceil(time);\n    if (time <= 0) {\n        str = \"00:00\";\n    } else if (time < 60) {\n        str = \"00:\" + changeLen(time);\n    } else if (time < 3600) {\n        m = Math.floor(time / 60);\n        s = time % 60;\n        str = changeLen(m) + \":\" + changeLen(s);\n    } else {\n        h = Math.floor(time / 3600);\n        str = time % 3600;\n        m = Math.floor(str / 60);\n        s = str % 60;\n        str = changeLen(h) + \":\" + changeLen(m) + \":\" + changeLen(s);\n    }\n    return str;\n}\n\nexport {\n    doc,\n    DEFAULT_OPTIONS,\n    ERROR_TYPE,\n    KEY_MAP,\n    isFunction,\n    isObject,\n    isString,\n    isUndefined,\n    isWindow\n};","import {doc, isFunction, isObject, isUndefined, isString, isWindow} from \"../global.js\";\nlet dom = {\n        handlers: {}\n    },\n    guid = 1;\n\ndom.hasClass = function (el, cls) {\n    if (!el) return false;\n    if (el.classList) {\n        return el.classList.contains(cls);\n    }\n    //如果className为XXX-active, cls为active,\n    //如果不加空格判断则获取的结果不准确\n    return (\" \" + el.className + \" \").indexOf(\" \" + cls + \" \") > -1;\n};\n\ndom.addClass = function (el, cls) {\n    if (el && !this.hasClass(el, cls)) {\n        if (el.classList) {\n            el.classList.add(cls);\n        } else {\n            el.className += \" \" + cls;\n        }\n    }\n    return this;\n};\n\ndom.removeClass = function (el, cls) {\n    let reg = new RegExp(\"\\\\s+\" + cls + \"\\\\s+\"),\n        className;\n    if (el && this.hasClass(el, cls)) {\n        className = \" \" + el.className + \" \";\n        if (el.classList) {\n            el.classList.remove(cls);\n        } else {\n            el.className = className.replace(reg, \" \").trim();\n        }\n    }\n    return this;\n};\n\ndom.toggleClass = function (el, cls) {\n    let reg = new RegExp(\"\\\\s+\" + cls + \"\\\\s+\"),\n        className;\n    if (el) {\n        if (el.classList) {\n            el.classList.toggle(cls);\n        } else {\n            className = \" \" + el.className + \" \";\n            cls = \" \" + cls + \" \";\n            if (className.indexOf(cls) > -1) {\n                el.className = className.replace(reg, \" \").trim();\n            } else {\n                el.className += \" \" + cls;\n            }\n        }\n    }\n    return this;\n};\n\ndom.css = function (el, prop, val) {\n    let css = \"\";\n    if (!isUndefined(val)) {\n        el.style[prop] = val;\n    } else {\n        if (isObject(prop)) {\n            for (val in prop) {\n                css += val + \":\" + prop[val] + \";\";\n            }\n            el.style.cssText += css;\n        } else if (isString(prop)) {\n            return getComputedStyle(el).getPropertyValue(prop);\n        }\n    }\n    return this;\n};\n\n//选择元素， 只选中一个\ndom.selectElement = function (selector, context) {\n    let ret,\n        reg = /^#[^>~+\\[\\]\\s:]+$/; //匹配id选择器\n    context = context || doc;\n    if (selector) {\n        if (selector.nodeName || isWindow(selector)) {\n            ret = selector;\n        } else if (typeof selector === \"string\") {\n            if (reg.test(selector)) {\n                ret = doc.getElementById(selector.substring(1));\n            } else {\n                ret = context.querySelector(selector);\n            }\n        }\n    }\n    return ret;\n};\n\n//创建元素\ndom.createElement = function (name, attrs) {\n    let el = doc.createElement(name),\n        key;\n    if (isObject(attrs)) {\n        for (key in attrs) {\n            el.setAttribute(key, attrs[key]);\n        }\n    }\n    return el;\n};\n\n//添加元素事件\ndom._on = function (el, type, callback) {\n    let id = el.guid,\n        handler;\n    if (!id) {\n        id = guid++;\n        Object.defineProperty(el, \"guid\", {\n            value: id\n        });\n    }\n    handler = this.handlers[id];\n    if (!handler) {\n        handler = this.handlers[id] = {};\n        handler[type] = [];\n    } else if (!handler[type]) {\n        handler[type] = [];\n    }\n    handler[type].push(callback);\n    el.addEventListener(type, callback);\n};\n\ndom.on = function (selector, type, callback, off) {\n    let el = this.selectElement(selector),\n        i;\n    if (el) {\n        if (type) {\n            //添加多个事件，以空格分开\n            type = type.split(\" \");\n            i = type.length;\n            if (isFunction(callback)) {\n                for (; i--;) {\n                    let t = type[i];\n                    off ? this._off(el, t, callback) :\n                        this._on(el, t, callback);\n                }\n            } else if(off){\n                for (; i--;) {\n                    this._off(el, type[i]);\n                }\n            }\n        } else if(off) {\n            this._off(el);\n        }\n\n    }\n    return this;\n};\n\n//移除元素的事件\ndom._off = function (el, type, callback) {\n    let handlers = this.handlers[el.guid];\n    if (handlers) {\n        if (type && (handlers = handlers[type])) {\n            if (callback) {\n                for (let i = 0, len = handlers.length; i < len; i++ ) {\n                    if (handlers[i] === callback) {\n                        handlers.splice(i, 1);\n                        el.removeEventListener(type, callback);\n                        break;\n                    }\n                }\n            } else {\n                handlers.forEach(function (fn) {\n                    el.removeEventListener(type, fn);\n                });\n                dom.handlers[type] = [];\n            }\n        } else if (!type) {//如果没有type, 则移除该元素的所有事件\n            for (let key in handlers) {\n                this._off(el, key);\n            }\n        }\n    }\n};\n\ndom.off = function (selector, type, callback) {\n    return this.on(selector, type, callback, true);\n};\n\ndom.once = function (selector, type, callback) {\n    let cb, _this = this;\n    if (isFunction(callback)) {\n        cb = function () {\n            let args = Array.prototype.slice.call(arguments);\n            callback.apply(this, args);\n            _this.off(selector, type, cb);\n        };\n        this.on(selector, type, cb);\n    }\n    return this;\n};\n\n/**\n * 判断一个坐标是否再元素内部（例如鼠标移动后判鼠标指针是否再元素上）\n * @param {HTMLElement} el html元素\n * @param {number} x x偏移量\n * @param {number} y y偏移量\n * @param {boolean} relative 为true时候x,y相对视口的坐标,否则相对于元素\n */\ndom.isPositionInEl = function (el, x, y, relative) {\n    let rect = el.getBoundingClientRect();\n    console.log(rect, x, y)\n    if (relative) {\n        x = x - rect.left;\n        y = y - rect.top;\n    }\n    console.log(x, y)\n    return x > 0 && x < rect.width && y > 0 && y < rect.height;\n};\n\nexport default dom;","import {isFunction, isString, toArray} from \"./global.js\";\nimport {isUndefined} from \"./global\";\n\nfunction CEvent(type) {\n    this.type = type;\n    this.data = null;\n    this.timeStamp = 0;\n}\n\nexport default class Subscriber {\n    constructor() {\n        Object.defineProperty(this, \"handlers\", {value: {}});\n    }\n\n    _on(type, fn) {\n        if (!this.handlers[type]) {\n            this.handlers[type] = [];\n        }\n        this.handlers[type].push(fn);\n    }\n\n    on(type, fn) {\n        if (isFunction(fn)) {\n            if (!isString(type)) {\n                throw new TypeError(\"事件类型只能为String\");\n            }\n            type = type.split(\" \");\n            for (let i = type.length; i--;) {\n                this._on(type[i], fn);\n            }\n        }\n        return this;\n    }\n\n    _off(type, fn) {\n        let handlers = this.handlers[type];\n        if (handlers) {\n            if (isFunction(fn)) {\n                for(let i = handlers.length; i--;) {\n                    if (fn === handlers[i]) {\n                        handlers.splice(i, 1);\n                        break;\n                    }\n                }\n            } else if (isUndefined(fn)) {\n                this.handlers[type] = [];\n            }\n        }\n    }\n\n    off(type, fn) {\n        let len = arguments.length;\n        if (len && isString(type)) {\n            let args = toArray(arguments, 1);\n            type = type.split(\" \");\n            for (let i = type.length; i--;) {\n                this._off.call(this, type[i], ...args);\n            }\n        } else if (!len) {\n            //没传参数则移除所有绑定\n            this.handlers = {};\n        }\n        return this;\n    }\n\n    once(type, fn) {\n        if (isFunction(fn)) {\n            let self = this,\n                f = function () {\n                    fn.apply(this, arguments);\n                    self.off(type, f);\n                };\n            this.on(type, f);\n        }\n    }\n\n    trigger(type) {\n        let args = toArray(arguments, 1),\n            h = this.handlers[type],\n            e;\n        if (h) {\n            e = new CEvent(type);\n            e.data = args;\n            e.timeStamp = Date.now();\n            args = [e].concat(args);\n            for (let i = h.length; i--; ) {\n                h[i].apply(this, args);\n            }\n        }\n        return this;\n    }\n}","import dom from \"../dom/index.js\";\n\nexport default class Loading {\n    constructor() {\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-loading rplayer-hide\"});\n    }\n\n    show() {\n        dom.removeClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    hide() {\n        dom.addClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    toggle() {\n        dom.toggleClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    init(target) {\n        target.appendChild(this.el);\n        return this;\n    }\n}\n","import dom from \"../dom/index.js\";\nimport {isFunction, noop} from \"../global.js\";\n\nexport default  class VideoError {\n    constructor() {\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-error rplayer-hide\"});\n        this.msgEl = dom.createElement(\"div\", {\"class\": \"rplayer-msg\"});\n        this.callback = noop();\n    }\n\n    show(msg) {\n        this.setMessage(msg);\n        dom.removeClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    hide() {\n        dom.addClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    setMessage(msg) {\n        this.msgEl.innerHTML = msg;\n        return this;\n    }\n\n    initEvent() {\n        dom.on(this.msgEl, \"click\", this.callback);\n        return this;\n    }\n\n    init(target, callback) {\n        this.el.appendChild(this.msgEl);\n        target.appendChild(this.el);\n        if (isFunction(callback)) {\n            this.callback = callback;\n        }\n        return this.initEvent();\n    }\n}","import dom from \"../../dom/index.js\";\nimport {doc, isUndefined} from \"../../global.js\";\nimport Subscriber from \"../../subscriber.js\";\nimport {ERROR_TYPE, removeProp} from \"../../global\";\n\nexport const VIDEO_LOADED_META = \"video.loaded.meta\";\nexport const VIDEO_TIME_UPDATE = \"video.time.update\";\nexport const VIDEO_SEEKING = \"video.seeking\";\nexport const VIDEO_LOAD_START = \"video.load.start\";\nexport const VIDEO_PROGRESS = \"video.progress\";\nexport const VIDEO_CAN_PLAY = \"video.can.play\";\nexport const VIDEO_ENDED = \"video.ended\";\nexport const VIDEO_ERROR = \"video.error\";\nexport const VIDEO_PLAYING = \"video.playing\";\nexport const VIDEO_PAUSE = \"video.pause\";\nexport const VIDEO_DBLCLICK = \"video.dblclick\";\nexport const VIDEO_CLICK = \"video.click\";\nexport const VIDEO_VOLUME_CHANGE = \"video.volume.change\";\n\nexport default class VideoControl extends Subscriber {\n    constructor(config) {\n        super();\n        this.config = config;\n        this.playedTime = null;\n        this.el = dom.createElement(\"video\", {\"class\": \"rplayer-video\"});\n    }\n\n    setVolume(volume) {\n        //音量只能设置0-1的值\n        if (volume > 1) {\n            volume = volume / 100;\n        }\n        this.el.volume = volume;\n        this.el.muted = !volume;\n        return this;\n    }\n    \n    getVolume() {\n        return Math.floor(this.el.volume * 100);\n    }\n\n    mute(mute) {\n        this.el.muted = isUndefined(mute) ? true : !!mute;\n        return this;\n    }\n\n    isMuted() {\n        return this.el.muted;\n    }\n\n    autoPlay(play) {\n        this.el.autoplay = !!play;\n        return this;\n    }\n\n    play(play) {\n        if (isUndefined(play) || !!play) {\n            this.el.play();\n        } else {\n            this.el.pause();\n        }\n        return this;\n    }\n\n    togglePlay() {\n        //当开始加载视频还不能播放时点击播放会报错\n        if (this.getDuration()) {\n            let paused = this.isPaused();\n            this.play(paused);\n        }\n        return this;\n    }\n\n    isPaused() {\n        return this.el.paused;\n    }\n\n    isError() {\n        let err = this.el.error;\n        return err ? err.code : err;\n    }\n\n    loop(isLoop) {\n        this.el.loop = !!isLoop;\n        return this;\n    }\n\n    setPoster(poster) {\n        this.el.poster = poster;\n        return this;\n    }\n\n    setPreload(preload) {\n        this.el.preload = preload;\n        return this;\n    }\n\n    setCurrentTime(time, scale) {\n        let duration = this.getDuration();\n        if (scale) {\n            time = duration * time;\n        }\n        this.el.currentTime = time;\n        return this;\n    }\n\n    getCurrentTime() {\n        return this.el.currentTime;\n    }\n\n    getDuration() {\n        return this.el.duration;\n    }\n\n    getBuffered(percent) {\n        let buffered = this.el.buffered,\n            len = buffered.length;\n        if (percent) {\n            //缓冲的百分比\n            return len ? buffered = buffered.end(len - 1) / this.getDuration() * 100 : null;\n        }\n        return buffered;\n    }\n\n    getReadyState() {\n        return this.el.readyState;\n    }\n\n    showControls() {\n        this.el.controls = true;\n        return this;\n    }\n\n    reload() {\n        this.el.load();\n        return this;\n    }\n\n    changeSource(src) {\n        let paused = this.isPaused();\n        if (this.source !== src) {\n            this.source = src;\n            this.initSource(src);\n        }\n        if (!paused) {\n            this.play(true);\n        }\n        return this;\n    }\n\n    getSource() {\n        return this.el.currentSrc;\n    }\n\n    initSource(source) {\n        let frag = doc.createDocumentFragment();\n        if (typeof source === \"string\") {\n            this.el.src = source;\n        } else if (Array.isArray(source)) {\n            this.el.innerHTML = \"\";\n            source.forEach(function (src) {\n                let sourceEl = dom.createElement(\"source\", {src: src});\n                frag.appendChild(sourceEl);\n            });\n            this.el.appendChild(frag);\n        }\n        return this;\n    }\n\n    handleError() {\n        let code = this.isError(),\n            err, message;\n        //出现错误保存当前播放进度，恢复后从当前进度继续播放\n        err = ERROR_TYPE[code];\n        switch (err) {\n            case \"MEDIA_ERR_ABORTED\":\n                message = \"出错了\";\n                break;\n            case \"MEDIA_ERR_NETWORK\":\n                message = \"网络错误或视频地址无效\";\n                break;\n            case \"MEDIA_ERR_DECODE\":\n            case \"MEDIA_ERR_SRC_NOT_SUPPORTED\":\n                message = \"解码失败,不支持的视频格式或地址无效\";\n        }\n        message += \",点击刷新\";\n        return {\n            code,\n            message\n        };\n    }\n\n    notify(type) {\n        let args = {\n                [VIDEO_LOADED_META]: [{duration: this.getDuration()}],\n                [VIDEO_TIME_UPDATE]: [this.getCurrentTime()],\n                [VIDEO_PROGRESS]: [this.getBuffered(true), this.getReadyState()],\n                [VIDEO_ERROR]: [this.handleError()],\n                [VIDEO_VOLUME_CHANGE]: [this.isMuted() ? 0 : this.getVolume()]\n            },\n            a = args[type] || [];\n        switch (type) {\n            case VIDEO_LOAD_START:\n                if (this.playedTime) {\n                    this.setCurrentTime(this.playedTime);\n                    this.playedTime = 0;\n                }\n                break;\n            case VIDEO_ERROR:\n                this.playedTime = this.getCurrentTime();\n        }\n        return this.trigger(type, ...a);\n    }\n\n    initEvent() {\n        let el = this.el;\n        dom.on(el, \"loadedmetadata\", this.notify.bind(this, VIDEO_LOADED_META))\n            .on(el, \"timeupdate\", this.notify.bind(this, VIDEO_TIME_UPDATE))\n            .on(el, \"seeking\", this.notify.bind(this, VIDEO_SEEKING))\n            .on(el, \"loadstart\", this.notify.bind(this, VIDEO_LOAD_START))\n            .on(el, \"progress\", this.notify.bind(this, VIDEO_PROGRESS))\n            .on(el, \"canplay seeked\", this.notify.bind(this, VIDEO_CAN_PLAY))\n            .on(el, \"ended\", this.notify.bind(this, VIDEO_ENDED))\n            .on(el, \"error\", this.notify.bind(this, VIDEO_ERROR))\n            .on(el, \"playing\", this.notify.bind(this, VIDEO_PLAYING))\n            .on(el, \"pause\", this.notify.bind(this, VIDEO_PAUSE))\n            .on(el, \"volumechange\", this.notify.bind(this, VIDEO_VOLUME_CHANGE))\n            .on(el, \"dblclick\", this.notify.bind(this, VIDEO_DBLCLICK))\n            .on(el, \"click\", this.notify.bind(this, VIDEO_CLICK))\n            .on(el, \"contextmenu\", evt => evt.preventDefault());\n    }\n\n    init(target) {\n        let video = this.el,\n            text = doc.createTextNode(this.config.msg.toString());\n        this.source = this.config.source;\n        if (this.config.useNativeControls) {\n            this.showControls();\n        }\n        video.appendChild(text);\n        target.appendChild(video);\n        this.initSource(this.source)\n            .autoPlay(this.config.autoPlay)\n            .loop(this.config.loop)\n            .setPoster(this.config.poster)\n            .setPreload(this.config.preload)\n            .initEvent();\n        return this;\n    }\n\n    destroy() {\n        dom.off(this.el);\n        this.off();\n        removeProp(this);\n    }\n}","import Subscriber from \"../subscriber.js\"\nimport {doc, isUndefined, removeProp} from \"../global.js\";\nimport dom from \"../dom/index.js\";\n\nexport const SLIDER_MOVING = \"slider.moving\";\nexport const SLIDER_MOVE_DONE = \"slider.move.done\";\n//滑块状态改变(是否可以滑动/点击),视频加载时候为获取到元信息禁止改变进度\nexport const SLIDER_STATUS_CHANGE = \"slider.status.change\";\n\nexport default class Slider extends Subscriber {\n    constructor(vertical) {\n        super();\n        this.vertical = isUndefined(vertical) ? false : !!vertical;\n        this.moveDis = this.pos = null;\n        this.moving = false;\n        this.enabled = true; //初始默认可以滑动/点击\n        this.track = dom.createElement(\"div\", {\"class\": \"rplayer-progress\"});\n        this.bar = dom.createElement(\"div\", {\"class\": \"rplayer-bar\"});\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-slider\"});\n    }\n\n\n    getPosition() {\n        let parent = this.el.parentNode,\n            rect = parent.getBoundingClientRect(),\n            pos = getComputedStyle(this.el);\n        return {\n            width: parseFloat(pos.width),\n            height: parseFloat(pos.height),\n            origLeft: parseFloat(pos.left),\n            origTop: parseFloat(pos.top),\n            maxX: rect.width,\n            maxY: rect.height\n        }\n    }\n\n    updateHPosition(val, scale) {\n        scale && (val = val * 100 + \"%\");\n        dom.css(this.bar, \"width\", val)\n            .css(this.el, \"left\", val);\n        return this;\n    }\n\n    updateVPosition(val, scale) {\n        scale && (val = val * 100 + \"%\");\n        dom.css(this.bar, \"height\", val)\n            .css(this.el, \"bottom\", val);\n        return this;\n    }\n\n    mouseDown(evt) {\n        //只有按鼠标左键时处理(evt.button=0)\n        if (!evt.button && this.enabled) {\n            let x = evt.clientX,\n                y = evt.clientY,\n                pos = this.getPosition(),\n                mouseMove = this.getMoveCallback().bind(this);\n            this.pos = {\n                width: pos.width,\n                height: pos.height,\n                offsetX: x - pos.origLeft,\n                offsetY: y - pos.origTop,\n                maxX: pos.maxX,\n                maxY: pos.maxY\n            };\n            dom.addClass(this.el, \"rplayer-moving\")\n                .on(doc, \"mousemove\", mouseMove)\n                .on(doc, \"mouseup\", this.mouseUp.bind(this))\n        }\n    }\n\n    moveVertical(x, y) {\n        let distance;\n        distance = this.pos.maxY - (y - this.pos.offsetY) - this.pos.height;\n        distance = distance < 0 ? 0 : distance > this.pos.maxY ? this.pos.maxY : distance;\n        distance = distance / this.pos.maxY;\n        this.updateVPosition(distance, true);\n        return distance;\n    }\n\n    moveHorizontal(x) {\n        let distance;\n        distance = x - this.pos.offsetX;\n        distance = distance < 0 ? 0 : distance > this.pos.maxX ? this.pos.maxX : distance;\n        distance = distance / this.pos.maxX;\n        this.updateHPosition(distance, true);\n        return distance;\n    }\n\n    mouseMove(evt, fn) {\n        let x = evt.clientX,\n            y = evt.clientY,\n            distance = fn.call(this, x, y);\n        this.moving = true;\n        this.trigger(SLIDER_MOVING, this.moveDis = distance);\n    }\n\n    getMoveCallback() {\n        return this.vertical ?\n            evt => this.mouseMove(evt, this.moveVertical) :\n            evt => this.mouseMove(evt, this.moveHorizontal);\n    }\n\n    mouseUp() {\n        dom.off(doc, \"mousemove mouseup\")\n            .removeClass(this.el, \"rplayer-moving\");\n        if (this.moving) {\n            this.trigger(SLIDER_MOVE_DONE, this.moveDis);\n            setTimeout(() => this.moving = false);\n        }\n    }\n\n    clickTrack(evt) {\n        //移动滑块鼠标释放时会触发父元素点击事件,可能会导致鼠标释放后滑块位置改变\n        //如果移动滑块/被禁用则点击事件不做处理\n        if (!this.moving && this.enabled) {\n            let rect = this.track.getBoundingClientRect(),\n                x = evt.clientX,\n                y = evt.clientY,\n                eType = \"slider.moving\";\n            if (this.vertical) {\n                rect = (rect.height - y + rect.top) / rect.height;\n                this.updateVPosition(rect, true);\n            } else {\n                rect = (x - rect.left) / rect.width;\n                eType = \"slider.move.done\";\n                this.updateHPosition(rect, true);\n            }\n            this.trigger(eType, rect);\n        }\n    }\n\n    initEvent() {\n        dom.on(this.el, \"mousedown\", this.mouseDown.bind(this))\n            .on(this.track, \"click\", this.clickTrack.bind(this));\n        this.on(SLIDER_STATUS_CHANGE, (evt, enable) => this.enabled = !!enable);\n        return this;\n    }\n\n    destroy() {\n        dom.off(this.track)\n            .off(this.el);\n        removeProp(this);\n    };\n\n    init(target) {\n        let cls = {\n            track: \"rplayer-video-track\",\n            bar: \"rplayer-video-progress\",\n            slider: \"rplayer-video-slider\"\n        };\n        if (this.vertical) {\n            cls = {\n                track: \"rplayer-volume-progress\",\n                bar: \"rplayer-volume-value\",\n                slider: \"rplayer-volume-slider\"\n            }\n        }\n        dom.addClass(this.track, cls.track)\n            .addClass(this.bar, cls.bar)\n            .addClass(this.el, cls.slider);\n        this.track.appendChild(this.bar);\n        this.track.append(this.el);\n        target.appendChild(this.track);\n        return this.initEvent();\n    };\n}","import dom from \"../dom/index.js\";\nimport {isObject} from \"../global.js\";\n\nexport default class Popup {\n    constructor(cls, autoHide) {\n        this.el = dom.createElement(\"div\", {\"class\": `rplayer-popup-info rplayer-hide ${cls}`});\n        this.visible = false;\n        this.autoHide = !!autoHide;\n        this.timer = null;\n    }\n\n    show(msg) {\n        this.visible = true;\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n        }\n        if (this.autoHide) {\n            this.timer = setTimeout(() => this.hide(), 3000);\n        }\n        dom.removeClass(this.el, \"rplayer-hide\");\n        msg && this.updateText(msg);\n        return this;\n    }\n\n    hide() {\n        this.visible = false;\n        dom.addClass(this.el, \"rplayer-hide\");\n        return this;\n    }\n\n    updatePosition(prop) {\n        let pos = {\n            left: \"left\",\n            right: \"right\",\n            top: \"top\",\n            bottom: \"bottom\"\n        };\n        if(isObject(prop)) {\n            for (let key in prop) {\n                if (pos[key]) {\n                    dom.css(this.el, key, prop[key]);\n                }\n            }\n        }\n        return this;\n    }\n\n    updateText(content) {\n        this.el.innerHTML = content;\n        return this;\n    }\n\n    getSize(prop) {\n        //隐藏元素获取不到尺寸信息，隐藏时先将元素显示出来获取之后再隐藏\n        let visible = this.visible;\n        !visible && this.show();\n        let style = getComputedStyle(this.el);\n        !visible && this.hide();\n        return prop ?\n            parseFloat(style[prop]) :\n            {\n                left: parseFloat(style.left),\n                right: parseFloat(style.right),\n                top: parseFloat(style.top),\n                bottom: parseFloat(style.bottom),\n                width: parseFloat(style.width),\n\n            }\n    }\n\n    width() {\n        return this.getSize(\"width\");\n    }\n\n    height() {\n        return this.getSize(\"height\");\n    }\n\n    init(target) {\n        target.appendChild(this.el);\n        return this;\n    }\n}","import dom from \"../../dom/index.js\";\nimport Slider, {SLIDER_MOVE_DONE, SLIDER_STATUS_CHANGE} from \"../slider.js\";\nimport Popup from \"../../message/popup.js\";\nimport {convertTime} from \"../../global.js\";\nimport Subscriber from \"../../subscriber.js\";\n\nexport const VIDEO_PROGRESS_UPDATE = \"video.progress.update\";\nexport const VIDEO_PROGRESS_UPDATED = \"video.progress.updated\";\nexport const VIDEO_PROGRESS_ENABLE = \"video.progress.enable\";\nexport const VIDEO_PROGRESS_BUFFER = \"video.progress.buffer\";\nexport const VIDEO_PROGRESS_DURATION = \"video.progress.duration\";\n\nexport default class VideoProgress extends Subscriber {\n    constructor() {\n        super();\n        this.slider = new Slider();\n        this.panel = dom.createElement(\"div\", {\"class\": \"rplayer-progress-panel\"});\n        this.bufferEl = dom.createElement(\"div\", {\"class\": \"rplayer-bufferd-bar\"});\n        this.popup = new Popup(\"rplayer-popup-video-info\");\n        this.currentTime = this.duration = 0;\n    }\n\n    update(current, sliderMove) {\n        if (this.currentTime !== current) {\n            this.currentTime = current;\n            let percent = current / this.duration * 100 || 0;\n            !sliderMove && this.slider.updateHPosition(percent + \"%\");\n        }\n        return this;\n    }\n\n    updateByStep(step) {\n        let currentTime = this.currentTime,\n            duration = this.duration;\n        if (duration) {\n            currentTime += step;\n            this.currentTime = currentTime < 0 ? 0 : currentTime > duration ? duration : currentTime;\n            this.trigger(VIDEO_PROGRESS_UPDATE, this.currentTime);\n        }\n        return this;\n    }\n\n    buffer(buffered) {\n        dom.css(this.bufferEl, buffered + \"%\");\n    }\n\n    mouseMove(evt) {\n        if (this.duration) {\n            this.popup.show();\n            let rect = this.panel.getBoundingClientRect(),\n                distance = evt.clientX - rect.left,\n                width = this.popup.width(),\n                left = distance - width / 2;\n            width = rect.width - width;\n            left = left < 0 ? 0 : left > width ? width : left;\n            width = distance / rect.width;\n            this.popup\n                .updatePosition({left: left + \"px\"})\n                .updateText(convertTime(width * this.duration));\n        }\n    }\n\n    mouseOut() {\n        this.popup.hide();\n    }\n\n    initEvent() {\n        //滑动改变进度/点击进度条改变进度\n        this.slider.on(SLIDER_MOVE_DONE, (evt, distance) => {\n            let time = distance * this.duration;\n            this.update(time);\n            this.trigger(VIDEO_PROGRESS_UPDATE, time);\n        });\n        dom.on(this.panel, \"mouseover mousemove\", this.mouseMove.bind(this))\n            .on(this.panel, \"mouseout\", this.mouseOut.bind(this));\n        this.on(VIDEO_PROGRESS_UPDATED, (evt, time) => this.update(time))\n            .on(VIDEO_PROGRESS_ENABLE, (evt, enabled) => this.slider.trigger(SLIDER_STATUS_CHANGE, enabled))\n            .on(VIDEO_PROGRESS_BUFFER, (evt, buffer) => this.buffer(buffer))\n            .on(VIDEO_PROGRESS_DURATION, (evt, duration) => this.duration = duration);\n        return this;\n    }\n\n    init(target) {\n        let el = this.panel;\n        el.appendChild(this.bufferEl);\n        this.slider.init(el);\n        this.popup.init(el);\n        target.appendChild(el);\n        return this.initEvent();\n    }\n}","import dom from \"../dom/index.js\";\nimport Slider, {SLIDER_MOVING} from \"./slider.js\";\nimport {doc} from \"../global\";\nimport Subscriber from \"../subscriber.js\";\n\nexport const VOLUME_CONTROL_UPDATE = \"volume.control.update\";\nexport const VOLUME_CONTROL_MUTE = \"volume.control.mute\";\n\nexport default class VolumeControl extends Subscriber {\n    constructor(volume) {\n        super();\n        this.panel = dom.createElement(\"div\", {\"class\": \"rplayer-volume-popup rplayer-hide\"});\n        this.valueEl = dom.createElement(\"div\", {\"class\": \"rplayer-current-volume\"});\n        this.muteBtn = dom.createElement(\"button\", {\"class\": \"rplayer-mute volume-1\"});\n        this.showBtn = dom.createElement(\"button\", {\"class\": \"rplayer-audio-btn volume-1\"});\n        this.slider = new Slider(true);\n        this.volume = volume;\n        this.muted = false;\n    }\n\n    show() {\n        dom.removeClass(this.panel, \"rplayer-hide\");\n        return this;\n    }\n\n    hide() {\n        dom.addClass(this.panel, \"rplayer-hide\");\n        return this;\n    }\n\n    toggle(evt) {\n        dom.toggleClass(this.panel, \"rplayer-hide\");\n        //document click事件点击音量设置面板之外隐藏,如果不阻止冒泡则面板显示不出来\n        evt.stopPropagation();\n        return this;\n    }\n\n    updateVolume(volume, sliderMove) {\n        this.volume = volume;\n        this.updateStyle(this.volume, sliderMove);\n        this.trigger(VOLUME_CONTROL_UPDATE, this.volume);\n        return this;\n    }\n\n    updateVolumeByStep(step) {\n        let volume = this.volume + step;\n        volume = volume > 100 ? 100 : volume < 0 ? 0 : volume;\n        this.updateVolume(volume);\n    }\n\n    updateStyle(volume, sliderMove) {\n        let muteCls = this.muteBtn.className,\n            showCls = this.showBtn.className,\n            reg = /volume-\\S+/;\n        muteCls = muteCls.replace(reg, \"\");\n        showCls = showCls.replace(reg, \"\");\n        if (!volume) {\n            reg= \"volume-mute\";\n        } else if (volume <= 33) {\n            reg= \"volume-1\";\n        } else if (volume <= 66) {\n            reg= \"volume-2\";\n        } else {\n            reg= \"volume-3\";\n        }\n        this.muteBtn.className = muteCls + reg;\n        this.showBtn.className = showCls + reg;\n        this.valueEl.innerHTML = volume;\n        //如果通过移动滑块改变音量则不重复改变slider的位置\n        !sliderMove && this.slider.updateVPosition(volume + \"%\");\n        return this;\n    }\n\n    mute() {\n        this.muted = !this.muted;\n        this.muted ? this.updateStyle(0) : this.updateStyle(this.volume);\n        this.trigger(VOLUME_CONTROL_MUTE, this.muted);\n    }\n\n    initEvent() {\n        dom.on(this.muteBtn, \"click\", this.mute.bind(this))\n            .on(this.panel, \"mouseleave\", this.hide.bind(this))\n            .on(this.showBtn, \"click\", this.toggle.bind(this))\n            .on(doc, \"click\", evt => {\n                let tgt = evt.target;\n                //点击页面其他地方（点击的不是音量设置面板或者面板内的元素）则隐藏音量面板\n                if (tgt !== this.panel && !this.panel.contains(tgt)) {\n                    this.hide();\n                }\n            });\n        this.slider.on(SLIDER_MOVING, (evt, distance) => {\n            this.updateVolume(Math.floor(100 * distance), true);\n        });\n        return this;\n    }\n\n    init(target) {\n        let panel = dom.createElement(\"div\", {\"class\": \"rplayer-audio-control rplayer-rt\"});\n        this.panel.appendChild(this.valueEl);\n        this.slider.init(this.panel);\n        this.panel.appendChild(this.muteBtn);\n        panel.appendChild(this.showBtn);\n        panel.append(this.panel);\n        target.appendChild(panel);\n        this.updateVolume(this.volume)\n            .initEvent();\n        return this;\n    }\n}","let fsApi = (function () {\n    let fullScreenApi = [\n            //W3C\n            [\n                \"requestFullscreen\",\n                \"exitFullscreen\",\n                \"fullscreenElement\",\n                \"fullscreenEnabled\",\n                \"fullscreenchange\",\n                \"fullscreenerror\"\n            ],\n            // WebKit\n            [\n                \"webkitRequestFullscreen\",\n                \"webkitExitFullscreen\",\n                \"webkitFullscreenElement\",\n                \"webkitFullscreenEnabled\",\n                \"webkitfullscreenchange\",\n                \"webkitfullscreenerror\"\n            ],\n            // Firefox\n            [\n                \"mozRequestFullScreen\",\n                \"mozCancelFullScreen\",\n                \"mozFullScreenElement\",\n                \"mozFullScreenEnabled\",\n                \"mozfullscreenchange\",\n                \"mozfullscreenerror\"\n            ],\n            // IE\n            [\n                \"msRequestFullscreen\",\n                \"msExitFullscreen\",\n                \"msFullscreenElement\",\n                \"msFullscreenEnabled\",\n                \"MSFullscreenChange\",\n                \"MSFullscreenError\"\n            ]\n\n        ],\n        fsApi = null,\n        defApi = fullScreenApi[0],\n        tmp, support;\n    for (let i = 0, len = fullScreenApi.length; i < len; i++) {\n        tmp = fullScreenApi[i];\n        if (tmp[1] in document) {\n            support = true;\n            break;\n        }\n    }\n\n    if (support) {\n        fsApi = {};\n        tmp.forEach(function (prop, i) {\n            fsApi[defApi[i]] = prop;\n        });\n    }\n    return fsApi;\n})();\n\nexport default fsApi;","import dom from \"../../dom/index.js\";\nimport {doc} from \"../../global.js\";\nimport fsApi from \"../../dom/fullscreen_api.js\";\n\nconst FULL_SCREEN_CLASS = \"rplayer-fullscreen\";\n\nexport default class FullScreen {\n    constructor(el) {\n        this.el = el;\n        this.isFullScreen = false;\n        this.btn = dom.createElement(\"button\", {\"class\": \"rplayer-fullscreen-btn rplayer-rt\"});\n    }\n    request() {\n        this.isFullScreen = true;\n        fsApi ?\n            this.el[fsApi.requestFullscreen]() :\n            this.fullPage();\n        dom.addClass(this.el, FULL_SCREEN_CLASS)\n            .addClass(this.btn, FULL_SCREEN_CLASS);\n        return this;\n    }\n\n    exit() {\n        this.isFullScreen = false;\n        fsApi ?\n            doc[fsApi.exitFullscreen]() :\n            this.fullPage(true);\n        dom.removeClass(this.btn, FULL_SCREEN_CLASS)\n            .removeClass(this.el, FULL_SCREEN_CLASS);\n        return this;\n    }\n\n    toggle() {\n        return this.isFullScreen = !this.isFullScreen ?\n            this.request() :\n            this.exit();\n    }\n\n    fullPage(exit) {\n        //不支持全屏的浏览器铺满页面可视区域\n        exit ?\n            dom.removeClass(this.el, \"rplayer-fixed\") :\n            dom.addClass(this.el, \"rplayer-fixed\");\n        return this;\n    }\n\n    initEvent() {\n        if (fsApi) {\n            dom.on(doc, fsApi.fullscreenchange, () => {\n                if (!doc[fsApi.fullscreenElement]) {\n                    this.exit();\n                }\n            }).on(doc, fsApi.fullscreenerror, () => {\n                this.exit();\n            });\n        }\n        dom.on(this.btn, \"click\", this.toggle.bind(this));\n        return this;\n    }\n\n    init(el, target) {\n        this.el = el;\n        target.appendChild(this.btn);\n        return this.initEvent();\n    }\n}\n","import dom from \"../dom/index.js\";\nimport {doc, convertTime} from \"../global.js\";\n\nexport default class TimeInfo {\n    constructor() {\n        this.currentEl = dom.createElement(\"span\", {\"class\": \"rplayer-current-time\"});\n        this.totalEl = dom.createElement(\"span\", {\"class\": \"rplayer-total-time\"});\n    }\n\n    updateCurrentTime(time) {\n        this.currentEl.innerHTML = convertTime(time);\n        return this;\n    }\n\n    updateTotalTime(time) {\n        this.totalEl.innerHTML = convertTime(time);\n        return this;\n    }\n\n    init(target) {\n        let el = dom.createElement(\"span\", {\"class\": \"rplayer-time-info\"}),\n            text = doc.createTextNode(\"/\");\n        this.currentEl.innerHTML = this.totalEl.innerHTML = \"00:00\";\n        el.appendChild(this.currentEl);\n        el.appendChild(text);\n        el.appendChild(this.totalEl);\n        target.appendChild(el);\n        return this;\n    }\n}","import dom from \"../../dom/index.js\";\nimport Subscriber from \"../../subscriber.js\";\n\nexport const PLAY_CONTROL_PLAY = \"play.control.play\";\nexport const PLAY_CONTROL_PAUSE = \"play.control.pause\";\nexport const PLAY_CONTROL_TOGGLE = \"play.control.toggle\";\n\nexport default class PlayControl extends Subscriber{\n    constructor() {\n        super();\n        this.btn = dom.createElement(\"button\", {\"class\": \"rplayer-play-btn\"});\n        this.paused = true;\n    }\n\n    play() {\n        dom.addClass(this.btn, \"paused\");\n        return this;\n    }\n\n    pause() {\n        dom.removeClass(this.btn, \"paused\");\n        return this;\n    }\n\n    toggle() {\n        this.trigger(PLAY_CONTROL_TOGGLE, this.paused = !this.paused);\n        return this;\n    }\n\n    initEvent() {\n        dom.on(this.btn, \"click\", this.toggle.bind(this));\n        this.on(PLAY_CONTROL_PAUSE, this.pause.bind(this))\n            .on(PLAY_CONTROL_PLAY, this.play.bind(this));\n        return this;\n    }\n\n    init(target) {\n        target.appendChild(this.btn);\n        return this.initEvent();\n    }\n}\n\n\n","import VideoProgress, {\n    VIDEO_PROGRESS_ENABLE,\n    VIDEO_PROGRESS_UPDATED,\n    VIDEO_PROGRESS_UPDATE,\n    VIDEO_PROGRESS_BUFFER,\n    VIDEO_PROGRESS_DURATION\n} from \"./video/video_progress.js\";\nimport VolumeControl, {VOLUME_CONTROL_MUTE, VOLUME_CONTROL_UPDATE} from \"./volume_control.js\";\nimport FullScreen from \"./video/fullscreen.js\";\nimport Popup from \"../message/popup.js\";\nimport TimeInfo from \"../message/time_info.js\";\nimport PlayControl, {PLAY_CONTROL_PAUSE, PLAY_CONTROL_PLAY, PLAY_CONTROL_TOGGLE} from \"./video/play_control.js\";\nimport dom from \"../dom/index.js\";\nimport {KEY_MAP} from \"../global.js\";\nimport {\n    VIDEO_VOLUME_CHANGE,\n    VIDEO_LOAD_START,\n    VIDEO_LOADED_META,\n    VIDEO_PROGRESS,\n    VIDEO_TIME_UPDATE,\n    VIDEO_PAUSE,\n    VIDEO_PLAYING,\n    VIDEO_CLICK,\n    VIDEO_DBLCLICK\n} from \"./video/video_control.js\";\n\n\nexport default class Controls {\n    constructor(parent, media, volume) {\n        this.parentEl = parent;\n        this.media = media;\n        this.timer = null;\n        this.el = dom.createElement(\"div\", {\"class\": \"rplayer-controls\"});\n        this.volumeControl = new VolumeControl(volume);\n        this.playControl = new PlayControl();\n        this.timeInfo = new TimeInfo();\n        this.fullScreen = new FullScreen();\n        this.progress = new VideoProgress();\n        this.volumePopup = new Popup(\"rplayer-popup-volume-info\", true);\n    }\n\n    show(evt = {}) {\n        let error = this.media.isError();\n        if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n        }\n        if (!error) {\n            let mouseX = evt.clientX;\n            let mouseY = evt.clientY;\n            this.visible = true;\n            dom.removeClass(this.el, \"rplayer-hide\");\n            this.timer = setTimeout(() => {\n                this.hide(mouseX, mouseY);\n            }, 5000);\n        }\n        return this;\n    }\n\n    hide(mouseX, mouseY) {\n        console.log(dom.isPositionInEl(this.el, mouseX, mouseY, true))\n        if (!dom.isPositionInEl(this.el, mouseX, mouseY, true)) {\n            dom.addClass(this.el, \"rplayer-hide\");\n        }\n        return this;\n    }\n\n    keyDown(evt) {\n        let key = evt.key.toLowerCase(),\n            regUpOrDown = /(?:up)|(?:down)/,\n            regLeftOrRight = /(?:left)|(?:right)/,\n            regEsc = /esc/,\n            regSpace = /\\s|(?:spacebar)/,\n            tmp = KEY_MAP[key];\n        if (tmp) {\n            if (regLeftOrRight.test(key)) {\n                this.progress.updateByStep(tmp);\n            } else if (regUpOrDown.test(key)) {\n                this.volumeControl.updateVolumeByStep(tmp);\n            } else if (regEsc.test(key)) {\n                this.fullScreen.exit();\n            } else if (regSpace.test(key)) {\n                this.playControl.toggle();\n            }else {\n                this.fullScreen.toggle();\n            }\n        }\n        evt.preventDefault();\n    }\n\n    showVolumePopup(volume) {\n        let text = `当前音量: ${volume}`;\n        if (volume === 0) {\n            text = \"静音\";\n        }\n        this.volumePopup.show(text);\n        return this;\n    }\n\n    initEvent() {\n        let media = this.media,\n            playCtrl = this.playControl,\n            progress = this.progress;\n        media.on(VIDEO_VOLUME_CHANGE, (evt, volume) => this.showVolumePopup(volume))\n            .on(VIDEO_PLAYING, () => playCtrl.trigger(PLAY_CONTROL_PLAY))\n            .on(VIDEO_PAUSE, () => playCtrl.trigger(PLAY_CONTROL_PAUSE))\n            .on(VIDEO_LOAD_START, () => progress.trigger(VIDEO_PROGRESS_ENABLE, false))\n            .on(VIDEO_LOADED_META, (evt, meta) => {\n                let duration = meta.duration;\n                this.timeInfo.updateTotalTime(duration);\n                progress.trigger(VIDEO_PROGRESS_ENABLE, true);\n                progress.trigger(VIDEO_PROGRESS_DURATION, duration);\n            })\n            .on(VIDEO_TIME_UPDATE, (evt, current) => {\n                this.timeInfo.updateCurrentTime(current);\n                progress.trigger(VIDEO_PROGRESS_UPDATED, current)\n            })\n            .on(VIDEO_PROGRESS, (evt, buffered) => progress.trigger(VIDEO_PROGRESS_BUFFER, buffered))\n            .on(VIDEO_CLICK, () => media.togglePlay())\n            .on(VIDEO_DBLCLICK, () => this.fullScreen.toggle());\n        playCtrl.on(PLAY_CONTROL_TOGGLE, (evt, paused) => media.play(paused));\n        progress.on(VIDEO_PROGRESS_UPDATE, (evt, time) => {\n            media.setCurrentTime(time);\n            this.timeInfo.updateCurrentTime(time);\n        });\n        this.volumeControl\n            .on(VOLUME_CONTROL_MUTE, (evt, muted) => media.mute(muted))\n            .on(VOLUME_CONTROL_UPDATE, (evt, volume) => media.setVolume(volume));\n        dom.on(this.parentEl, \"keydown\", this.keyDown.bind(this))\n            .on(this.parentEl, \"mousemove\", this.show.bind(this));\n        return this;\n    }\n\n    init() {\n        let settingsPanel = dom.createElement(\"div\", {\"class\": \"rplayer-settings rplayer-rt\"}),\n            playControl = dom.createElement(\"div\", {\"class\": \"rplayer-play-control rplayer-lf\"}),\n            el = this.el;\n        this.initEvent();\n        this.fullScreen.init(this.parentEl, settingsPanel);\n        this.volumeControl.init(settingsPanel);\n        this.playControl.init(playControl);\n        this.timeInfo.init(playControl);\n        this.progress.init(el);\n        this.volumePopup.init(el);\n        el.appendChild(settingsPanel);\n        el.appendChild(playControl);\n        this.parentEl.appendChild(el);\n        this.show();\n        return this;\n    }\n}","import dom from \"./dom/index.js\";\nimport {DEFAULT_OPTIONS, isObject, isUndefined, removeProp} from \"./global.js\";\nimport Subscriber from \"./subscriber.js\";\nimport Loading from \"./message/loading.js\";\nimport VideoError from \"./message/error.js\";\nimport VideoControl, {\n    VIDEO_CAN_PLAY,\n    VIDEO_ENDED,\n    VIDEO_ERROR,\n    VIDEO_LOAD_START,\n    VIDEO_PROGRESS,\n    VIDEO_SEEKING,\n} from \"./controls/video/video_control.js\";\nimport Controls from \"./controls/index.js\";\n\nconst DEFAULT_HEIGHT = 500;\n\nfunction handleConfig(options) {\n    return isObject(options) ?\n        {\n            autoPlay: !!options.autoPlay,\n            loop: !!options.loop,\n            defaultVolume: Math.abs(parseInt(options.defaultVolume)) || DEFAULT_OPTIONS.defaultVolume,\n            msg: options.msg || DEFAULT_OPTIONS.msg,\n            poster: options.poster || DEFAULT_OPTIONS.poster,\n            preload: options.preload || DEFAULT_OPTIONS.preload,\n            source: options.source,\n            useNativeControls: isUndefined(options.useNativeControls) ? false : options.useNativeControls\n        } : DEFAULT_OPTIONS;\n}\n\nexport default class RPlayer extends Subscriber {\n    constructor(selector, options) {\n        let target = dom.selectElement(selector),\n            config = handleConfig(options);\n        super();\n        if (!config.source) {\n            throw new Error(\"没有设置视频链接\");\n        }\n        if (!target) {\n            throw new Error(\"未选中任何元素\");\n        }\n        this.target = target;\n        this.loading = new Loading();\n        this.video = new VideoControl(config);\n        this.container = dom.createElement(\"div\", {\n            \"tabIndex\": 100, //使元素能够获取焦点\n            \"class\": \"rplayer-container\"\n        });\n        //播放控制与原生控制二选一，如果设置了useNativeControls为true，则优先使用原生控制\n        if((isUndefined(options.controls) ? true : !!options.controls) && !config.useNativeControls) {\n            this.controls = new Controls(this.container, this.video, config.defaultVolume);\n        }\n    }\n\n    buffer(buffered, readyState) {\n        if (readyState < 3) {\n            this.loading.show();\n        }\n    }\n\n    playEnd() {\n        this.trigger(\"play.end\");\n    }\n\n    handleError(error) {\n        if (!this.error) {\n            this.error = new VideoError();\n            this.error.init(this.container, this.refresh.bind(this));\n        }\n        this.loading.hide();\n        this.error.show(error.message);\n        return this;\n    }\n\n    refresh() {\n        this.video.reload();\n        this.error.hide();\n    };\n\n    initEvent() {\n        this.video\n            .on(VIDEO_LOAD_START, () => this.loading.show())\n            .on(VIDEO_PROGRESS, (evt, buffered, readyState) => this.buffer(buffered, readyState))\n            .on(VIDEO_SEEKING, () => this.loading.show())\n            .on(VIDEO_CAN_PLAY, () => this.loading.hide())\n            .on(VIDEO_ENDED, this.playEnd.bind(this))\n            .on(VIDEO_ERROR, (evt, error) => this.handleError(error));\n        return this;\n    };\n\n    getSource() {\n        return this.video.getSource();\n    };\n\n    updateSource(src) {\n        this.video.changeSource(src);\n    };\n\n    initialize() {\n        let container = this.container,\n            height = parseInt(getComputedStyle(this.target).height);\n        if (!container.parentNode) {\n            dom.css(container, \"height\", (height || DEFAULT_HEIGHT) + \"px\");\n            this.video.init(container);\n            this.loading.init(container);\n            this.controls && this.controls.init();\n            this.target.appendChild(container);\n            this.initEvent();\n        }\n        return this;\n    };\n}\n\nRPlayer.init = function (selector, options) {\n    return new RPlayer(selector, options).initialize();\n};"],"names":["DEFAULT_OPTIONS","ERROR_TYPE","TYPE","VOLUME_STEP","VIDEO_STEP","KEY_MAP","doc","document","isType","Object","prototype","toString","call","obj","type","isFunction","isObject","isString","isUndefined","isWindow","window","toArray","likeArr","start","Array","isArray","slice","length","removeProp","prop","e","noop","convertTime","time","changeLen","num","str","h","m","s","Math","ceil","floor","dom","guid","hasClass","el","cls","classList","contains","className","indexOf","addClass","add","removeClass","reg","RegExp","remove","replace","trim","toggleClass","toggle","css","val","style","cssText","getComputedStyle","getPropertyValue","selectElement","selector","context","ret","nodeName","test","getElementById","substring","querySelector","createElement","name","attrs","key","setAttribute","_on","callback","id","handler","defineProperty","handlers","push","addEventListener","on","off","i","split","t","_off","len","splice","removeEventListener","forEach","fn","once","cb","_this","args","arguments","apply","isPositionInEl","x","y","relative","rect","getBoundingClientRect","log","left","top","width","height","CEvent","data","timeStamp","Subscriber","value","TypeError","self","f","Date","now","concat","Loading","target","appendChild","VideoError","msgEl","msg","setMessage","innerHTML","initEvent","VIDEO_LOADED_META","VIDEO_TIME_UPDATE","VIDEO_SEEKING","VIDEO_LOAD_START","VIDEO_PROGRESS","VIDEO_CAN_PLAY","VIDEO_ENDED","VIDEO_ERROR","VIDEO_PLAYING","VIDEO_PAUSE","VIDEO_DBLCLICK","VIDEO_CLICK","VIDEO_VOLUME_CHANGE","VideoControl","config","playedTime","volume","muted","mute","play","autoplay","pause","getDuration","paused","isPaused","err","error","code","isLoop","loop","poster","preload","scale","duration","currentTime","percent","buffered","end","readyState","controls","load","src","source","initSource","currentSrc","frag","createDocumentFragment","sourceEl","isError","message","getCurrentTime","getBuffered","getReadyState","handleError","isMuted","getVolume","a","setCurrentTime","trigger","notify","bind","evt","preventDefault","video","text","createTextNode","useNativeControls","showControls","autoPlay","setPoster","setPreload","SLIDER_MOVING","SLIDER_MOVE_DONE","SLIDER_STATUS_CHANGE","Slider","vertical","moveDis","pos","moving","enabled","track","bar","parent","parentNode","parseFloat","button","clientX","clientY","getPosition","mouseMove","getMoveCallback","origLeft","origTop","maxX","maxY","mouseUp","distance","offsetY","updateVPosition","offsetX","updateHPosition","moveVertical","moveHorizontal","eType","mouseDown","clickTrack","enable","slider","append","Popup","autoHide","visible","timer","setTimeout","hide","updateText","content","show","right","bottom","getSize","VIDEO_PROGRESS_UPDATE","VIDEO_PROGRESS_UPDATED","VIDEO_PROGRESS_ENABLE","VIDEO_PROGRESS_BUFFER","VIDEO_PROGRESS_DURATION","VideoProgress","panel","bufferEl","popup","current","sliderMove","step","updatePosition","update","mouseOut","buffer","init","VOLUME_CONTROL_UPDATE","VOLUME_CONTROL_MUTE","VolumeControl","valueEl","muteBtn","showBtn","stopPropagation","updateStyle","updateVolume","muteCls","showCls","tgt","fsApi","fullScreenApi","defApi","tmp","support","FULL_SCREEN_CLASS","FullScreen","isFullScreen","btn","requestFullscreen","fullPage","exitFullscreen","request","exit","fullscreenchange","fullscreenElement","fullscreenerror","TimeInfo","currentEl","totalEl","PLAY_CONTROL_PLAY","PLAY_CONTROL_PAUSE","PLAY_CONTROL_TOGGLE","PlayControl","Controls","media","parentEl","volumeControl","playControl","timeInfo","fullScreen","progress","volumePopup","mouseX","mouseY","toLowerCase","regUpOrDown","regLeftOrRight","regEsc","regSpace","updateByStep","updateVolumeByStep","playCtrl","showVolumePopup","meta","updateTotalTime","updateCurrentTime","togglePlay","setVolume","keyDown","settingsPanel","DEFAULT_HEIGHT","handleConfig","options","abs","parseInt","defaultVolume","RPlayer","Error","loading","container","refresh","reload","playEnd","getSource","changeSource","initialize"],"mappings":"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"}